/*! For license information please see 5166.4360ce9f.chunk.js.LICENSE.txt */
(self.webpackChunkugc_suite_build=self.webpackChunkugc_suite_build||[]).push([[5166],{39968:function(e){e.exports=function(e){if("number"!==typeof e||isNaN(e))throw new TypeError("Expected a number, got ".concat(typeof e));var t=e<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return"".concat((t?"-":"")+e," B");var r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),n.length-1);e=Number(e/Math.pow(1024,r));var i=n[r];return e>=10||e%1===0?"".concat((t?"-":"")+e.toFixed(0)," ").concat(i):"".concat((t?"-":"")+e.toFixed(1)," ").concat(i)}},79773:function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},33881:function(e,t,n){var r="Expected a function",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,p=l||c||Function("return this")(),f=Object.prototype.toString,h=Math.max,d=Math.min,v=function(){return p.Date.now()};function y(e,t,n){var i,o,s,a,u,l,c=0,p=!1,f=!1,y=!0;if("function"!=typeof e)throw new TypeError(r);function b(t){var n=i,r=o;return i=o=void 0,c=t,a=e.apply(r,n)}function _(e){return c=e,u=setTimeout(k,t),p?b(e):a}function w(e){var n=e-l;return void 0===l||n>=t||n<0||f&&e-c>=s}function k(){var e=v();if(w(e))return Z(e);u=setTimeout(k,function(e){var n=t-(e-l);return f?d(n,s-(e-c)):n}(e))}function Z(e){return u=void 0,y&&i?b(e):(i=o=void 0,a)}function O(){var e=v(),n=w(e);if(i=arguments,o=this,l=e,n){if(void 0===u)return _(l);if(f)return u=setTimeout(k,t),b(l)}return void 0===u&&(u=setTimeout(k,t)),a}return t=g(t)||0,m(n)&&(p=!!n.leading,s=(f="maxWait"in n)?h(g(n.maxWait)||0,t):s,y="trailing"in n?!!n.trailing:y),O.cancel=function(){void 0!==u&&clearTimeout(u),c=0,i=l=o=u=void 0},O.flush=function(){return void 0===u?a:Z(v())},O}function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||a.test(e)?u(e.slice(2),n?2:8):o.test(e)?NaN:+e}e.exports=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError(r);return m(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),y(e,t,{leading:i,maxWait:t,trailing:o})}},92026:function(e,t,n){var r=n(10145),i=/[\/\+\.]/;e.exports=function(e,t){function n(t){var n=r(t,e,i);return n&&n.length>=2}return t?n(t.split(";")[0]):n}},15336:function(e){e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,n,r,i,o,s,a){var u=function(e){var n=t[e]?t[e]:[],r=e.indexOf(":"),i=-1===r?[e]:[e.substring(0,r),e.substring(r+1)],o=Object.keys(t),s=0,a=o.length;for(;s<a;s++){var u=o[s];if("*"===u&&(n=n.concat(t[u])),2===i.length&&i[0]===u){n=n.concat(t[u]);break}}return n}(e);u.length&&function(e,t,n){var r=0,i=t.length;for(;r<i&&t[r];r++)t[r].event=e,t[r].apply(t[r],n)}(e,u,[n,r,i,o,s,a])},e.on=function(e,n){t[e]||(t[e]=[]),t[e].push(n)},e.once=function(t,n){this.on(t,(function r(){n.apply(this,arguments),e.off(t,r)}))},e.off=function(e,t){var n=[];if(e&&t)for(var r=this._fns[e],i=0,o=r?r.length:0;i<o;i++)r[i]!==t&&n.push(r[i]);n.length?this._fns[e]=n:delete this._fns[e]},e}},58620:function(e,t,n){"use strict";n.d(t,{HY:function(){return y},Tm:function(){return L},Vf:function(){return v},bR:function(){return O},h:function(){return h},sY:function(){return N},wA:function(){return m}});var r,i,o,s,a,u={},l=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(e,t){for(var n in t)e[n]=t[n];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function h(e,t,n){var i,o,s,a={};for(s in t)"key"==s?i=t[s]:"ref"==s?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return d(e,a,i,o,null)}function d(e,t,n,r,s){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++o:s};return null==s&&null!=i.vnode&&i.vnode(a),a}function v(){return{current:null}}function y(e){return e.children}function m(e,t){this.props=e,this.context=t}function g(e,t){if(null==t)return e.__?g(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?g(e):null}function b(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return b(e)}}function _(e){(!e.__d&&(e.__d=!0)&&s.push(e)&&!w.__r++||a!==i.debounceRendering)&&((a=i.debounceRendering)||setTimeout)(w)}function w(){for(var e;w.__r=s.length;)e=s.sort((function(e,t){return e.__v.__b-t.__v.__b})),s=[],e.some((function(e){var t,n,r,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=p({},i)).__v=i.__v+1,R(s,i,r,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[o]:null,n,null==o?g(i):o,i.__h),U(n,i),i.__e!=o&&b(i)))}))}function k(e,t,n,r,i,o,s,a,c,p){var f,h,v,m,b,_,w,k=r&&r.__k||l,O=k.length;for(n.__k=[],f=0;f<t.length;f++)if(null!=(m=n.__k[f]=null==(m=t[f])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m||"bigint"==typeof m?d(null,m,null,null,m):Array.isArray(m)?d(y,{children:m},null,null,null):m.__b>0?d(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m)){if(m.__=n,m.__b=n.__b+1,null===(v=k[f])||v&&m.key==v.key&&m.type===v.type)k[f]=void 0;else for(h=0;h<O;h++){if((v=k[h])&&m.key==v.key&&m.type===v.type){k[h]=void 0;break}v=null}R(e,m,v=v||u,i,o,s,a,c,p),b=m.__e,(h=m.ref)&&v.ref!=h&&(w||(w=[]),v.ref&&w.push(v.ref,null,m),w.push(h,m.__c||b,m)),null!=b?(null==_&&(_=b),"function"==typeof m.type&&m.__k===v.__k?m.__d=c=Z(m,c,e):c=P(e,m,v,k,b,c),"function"==typeof n.type&&(n.__d=c)):c&&v.__e==c&&c.parentNode!=e&&(c=g(v))}for(n.__e=_,f=O;f--;)null!=k[f]&&C(k[f],k[f]);if(w)for(f=0;f<w.length;f++)T(w[f],w[++f],w[++f])}function Z(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?Z(r,t,n):P(n,r,r,i,r.__e,t));return t}function O(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){O(e,t)})):t.push(e)),t}function P(e,t,n,r,i,o){var s,a,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(a=o,u=0;(a=a.nextSibling)&&u<r.length;u+=1)if(a==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function S(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||c.test(t)?n:n+"px"}function E(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||S(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||S(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?A:x,o):e.removeEventListener(t,o?A:x,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function x(e){this.l[e.type+!1](i.event?i.event(e):e)}function A(e){this.l[e.type+!0](i.event?i.event(e):e)}function R(e,t,n,r,o,s,a,u,l){var c,f,h,d,v,g,b,_,w,Z,O,P,S,E,x,A=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(l=n.__h,u=t.__e=n.__e,t.__h=null,s=[u]),(c=i.__b)&&c(t);try{e:if("function"==typeof A){if(_=t.props,w=(c=A.contextType)&&r[c.__c],Z=c?w?w.props.value:c.__:r,n.__c?b=(f=t.__c=n.__c).__=f.__E:("prototype"in A&&A.prototype.render?t.__c=f=new A(_,Z):(t.__c=f=new m(_,Z),f.constructor=A,f.render=F),w&&w.sub(f),f.props=_,f.state||(f.state={}),f.context=Z,f.__n=r,h=f.__d=!0,f.__h=[],f._sb=[]),null==f.__s&&(f.__s=f.state),null!=A.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=p({},f.__s)),p(f.__s,A.getDerivedStateFromProps(_,f.__s))),d=f.props,v=f.state,h)null==A.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==A.getDerivedStateFromProps&&_!==d&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(_,Z),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(_,f.__s,Z)||t.__v===n.__v){for(f.props=_,f.state=f.__s,t.__v!==n.__v&&(f.__d=!1),f.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),O=0;O<f._sb.length;O++)f.__h.push(f._sb[O]);f._sb=[],f.__h.length&&a.push(f);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(_,f.__s,Z),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(d,v,g)}))}if(f.context=Z,f.props=_,f.__v=t,f.__P=e,P=i.__r,S=0,"prototype"in A&&A.prototype.render){for(f.state=f.__s,f.__d=!1,P&&P(t),c=f.render(f.props,f.state,f.context),E=0;E<f._sb.length;E++)f.__h.push(f._sb[E]);f._sb=[]}else do{f.__d=!1,P&&P(t),c=f.render(f.props,f.state,f.context),f.state=f.__s}while(f.__d&&++S<25);f.state=f.__s,null!=f.getChildContext&&(r=p(p({},r),f.getChildContext())),h||null==f.getSnapshotBeforeUpdate||(g=f.getSnapshotBeforeUpdate(d,v)),x=null!=c&&c.type===y&&null==c.key?c.props.children:c,k(e,Array.isArray(x)?x:[x],t,n,r,o,s,a,u,l),f.base=t.__e,t.__h=null,f.__h.length&&a.push(f),b&&(f.__E=f.__=null),f.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=j(n.__e,t,n,r,o,s,a,l);(c=i.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=s)&&(t.__e=u,t.__h=!!l,s[s.indexOf(u)]=null),i.__e(e,t,n)}}function U(e,t){i.__c&&i.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){i.__e(e,t.__v)}}))}function j(e,t,n,i,o,s,a,l){var c,p,h,d=n.props,v=t.props,y=t.type,m=0;if("svg"===y&&(o=!0),null!=s)for(;m<s.length;m++)if((c=s[m])&&"setAttribute"in c==!!y&&(y?c.localName===y:3===c.nodeType)){e=c,s[m]=null;break}if(null==e){if(null===y)return document.createTextNode(v);e=o?document.createElementNS("http://www.w3.org/2000/svg",y):document.createElement(y,v.is&&v),s=null,l=!1}if(null===y)d===v||l&&e.data===v||(e.data=v);else{if(s=s&&r.call(e.childNodes),p=(d=n.props||u).dangerouslySetInnerHTML,h=v.dangerouslySetInnerHTML,!l){if(null!=s)for(d={},m=0;m<e.attributes.length;m++)d[e.attributes[m].name]=e.attributes[m].value;(h||p)&&(h&&(p&&h.__html==p.__html||h.__html===e.innerHTML)||(e.innerHTML=h&&h.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||E(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||E(e,o,t[o],n[o],r)}(e,v,d,o,l),h)t.__k=[];else if(m=t.props.children,k(e,Array.isArray(m)?m:[m],t,n,i,o&&"foreignObject"!==y,s,a,s?s[0]:n.__k&&g(n,0),l),null!=s)for(m=s.length;m--;)null!=s[m]&&f(s[m]);l||("value"in v&&void 0!==(m=v.value)&&(m!==e.value||"progress"===y&&!m||"option"===y&&m!==d.value)&&E(e,"value",m,d.value,!1),"checked"in v&&void 0!==(m=v.checked)&&m!==e.checked&&E(e,"checked",m,d.checked,!1))}return e}function T(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function C(e,t,n){var r,o;if(i.unmount&&i.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||T(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){i.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&C(r[o],t,n||"function"!=typeof e.type);n||null==e.__e||f(e.__e),e.__=e.__e=e.__d=void 0}function F(e,t,n){return this.constructor(e,n)}function N(e,t,n){var o,s,a;i.__&&i.__(e,t),s=(o="function"==typeof n)?null:n&&n.__k||t.__k,a=[],R(t,e=(!o&&n||t).__k=h(y,null,[e]),s||u,u,void 0!==t.ownerSVGElement,!o&&n?[n]:s?null:t.firstChild?r.call(t.childNodes):null,a,!o&&n?n:s?s.__e:t.firstChild,o),U(a,e)}function L(e,t,n){var i,o,s,a=p({},e.props);for(s in t)"key"==s?i=t[s]:"ref"==s?o=t[s]:a[s]=t[s];return arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),d(e.type,a,i||e.key,o||e.ref,null)}r=l.slice,i={__e:function(e,t,n,r){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},o=0,m.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(p({},n),this.props)),e&&p(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),_(this))},m.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),_(this))},m.prototype.render=y,s=[],w.__r=0},96962:function(e,t){"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function i(e){try{return encodeURIComponent(e)}catch(t){return null}}t.stringify=function(e,t){t=t||"";var r,o,s=[];for(o in"string"!==typeof t&&(t="?"),e)if(n.call(e,o)){if((r=e[o])||null!==r&&undefined!==r&&!isNaN(r)||(r=""),o=i(o),r=i(r),null===o||null===r)continue;s.push(o+"="+r)}return s.length?t+s.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var o=r(t[1]),s=r(t[2]);null===o||null===s||o in i||(i[o]=s)}return i}},43841:function(e){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},65915:function(e,t,n){"use strict";var r=n(43841),i=n(96962),o=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,u=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function p(e){return(e||"").toString().replace(o,"")}var f=[["#","hash"],["?","query"],function(e,t){return v(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};function d(e){var t,r=("undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{}).location||{},i={},o=typeof(e=e||r);if("blob:"===e.protocol)i=new m(unescape(e.pathname),{});else if("string"===o)for(t in i=new m(e,{}),h)delete i[t];else if("object"===o){for(t in e)t in h||(i[t]=e[t]);void 0===i.slashes&&(i.slashes=a.test(e.href))}return i}function v(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function y(e,t){e=(e=p(e)).replace(s,""),t=t||{};var n,r=l.exec(e),i=r[1]?r[1].toLowerCase():"",o=!!r[2],a=!!r[3],u=0;return o?a?(n=r[2]+r[3]+r[4],u=r[2].length+r[3].length):(n=r[2]+r[4],u=r[2].length):a?(n=r[3]+r[4],u=r[3].length):n=r[4],"file:"===i?u>=2&&(n=n.slice(2)):v(i)?n=r[4]:i?o&&(n=n.slice(2)):u>=2&&v(t.protocol)&&(n=r[4]),{protocol:i,slashes:o||v(i),slashesCount:u,rest:n}}function m(e,t,n){if(e=(e=p(e)).replace(s,""),!(this instanceof m))return new m(e,t,n);var o,a,u,l,h,g,b=f.slice(),_=typeof t,w=this,k=0;for("object"!==_&&"string"!==_&&(n=t,t=null),n&&"function"!==typeof n&&(n=i.parse),o=!(a=y(e||"",t=d(t))).protocol&&!a.slashes,w.slashes=a.slashes||o&&t.slashes,w.protocol=a.protocol||t.protocol||"",e=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||c.test(e))||!a.slashes&&(a.protocol||a.slashesCount<2||!v(w.protocol)))&&(b[3]=[/(.*)/,"pathname"]);k<b.length;k++)"function"!==typeof(l=b[k])?(u=l[0],g=l[1],u!==u?w[g]=e:"string"===typeof u?~(h="@"===u?e.lastIndexOf(u):e.indexOf(u))&&("number"===typeof l[2]?(w[g]=e.slice(0,h),e=e.slice(h+l[2])):(w[g]=e.slice(h),e=e.slice(0,h))):(h=u.exec(e))&&(w[g]=h[1],e=e.slice(0,h.index)),w[g]=w[g]||o&&l[3]&&t[g]||"",l[4]&&(w[g]=w[g].toLowerCase())):e=l(e,w);n&&(w.query=n(w.query)),o&&t.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==t.pathname)&&(w.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(o=!0),n.splice(r,1),s--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(w.pathname,t.pathname)),"/"!==w.pathname.charAt(0)&&v(w.protocol)&&(w.pathname="/"+w.pathname),r(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(~(h=w.auth.indexOf(":"))?(w.username=w.auth.slice(0,h),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=w.auth.slice(h+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(w.auth)),w.auth=w.password?w.username+":"+w.password:w.username),w.origin="file:"!==w.protocol&&v(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}m.prototype={set:function(e,t,n){var o=this;switch(e){case"query":"string"===typeof t&&t.length&&(t=(n||i.parse)(t)),o[e]=t;break;case"port":o[e]=t,r(t,o.protocol)?t&&(o.host=o.hostname+":"+t):(o.host=o.hostname,o[e]="");break;case"hostname":o[e]=t,o.port&&(t+=":"+o.port),o.host=t;break;case"host":o[e]=t,u.test(t)?(t=t.split(":"),o.port=t.pop(),o.hostname=t.join(":")):(o.hostname=t,o.port="");break;case"protocol":o.protocol=t.toLowerCase(),o.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";o[e]=t.charAt(0)!==s?s+t:t}else o[e]=t;break;case"username":case"password":o[e]=encodeURIComponent(t);break;case"auth":var a=t.indexOf(":");~a?(o.username=t.slice(0,a),o.username=encodeURIComponent(decodeURIComponent(o.username)),o.password=t.slice(a+1),o.password=encodeURIComponent(decodeURIComponent(o.password))):o.username=encodeURIComponent(decodeURIComponent(t))}for(var l=0;l<f.length;l++){var c=f[l];c[4]&&(o[c[1]]=o[c[1]].toLowerCase())}return o.auth=o.password?o.username+":"+o.password:o.username,o.origin="file:"!==o.protocol&&v(o.protocol)&&o.host?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(e){e&&"function"===typeof e||(e=i.stringify);var t,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var s=o+(n.protocol&&n.slashes||v(n.protocol)?"//":"");return n.username?(s+=n.username,n.password&&(s+=":"+n.password),s+="@"):n.password?(s+=":"+n.password,s+="@"):"file:"!==n.protocol&&v(n.protocol)&&!r&&"/"!==n.pathname&&(s+="@"),(":"===r[r.length-1]||u.test(n.hostname)&&!n.port)&&(r+=":"),s+=r+n.pathname,(t="object"===typeof n.query?e(n.query):n.query)&&(s+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(s+=n.hash),s}},m.extractProtocol=y,m.location=d,m.trimLeft=p,m.qs=i,e.exports=m},10145:function(e){"use strict";function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,n,r=!0,i=this.parts,o=i.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(n=(e||"").split(this.separator),t=0;r&&t<o;t++)"*"!==i[t]&&(r=t<n.length&&i[t]===n[t]);r=r&&n}else r=!1;else if("function"==typeof e.splice)for(r=[],t=e.length;t--;)this.match(e[t])&&(r[r.length]=e[t]);else if("object"==typeof e)for(var s in r={},e)this.match(s)&&(r[s]=e[s]);return r},e.exports=function(e,n,r){var i=new t(e,r||/[\/\.]/);return"undefined"!=typeof n?i.match(n):i}},97657:function(e,t,n){"use strict";n.d(t,{zt:function(){return C},C$:function(){return P},sk:function(){return H}});var r={};n.r(r),n.d(r,{getItem:function(){return j},removeItem:function(){return T},setItem:function(){return U}});var i=n(70885),o=n(4942),s=n(74165),a=n(1413),u=n(15671),l=n(43144),c=n(15861),p=n(73411),f=n(51853),h=n(60136),d=n(29388),v=function(e){(0,h.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,"Authorization required")).name="AuthError",e.isAuthError=!0,e}return(0,l.Z)(n)}((0,n(98737).Z)(Error));function y(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var m=0;function g(e){return"__private_"+m+++"_"+e}function b(e){return _.apply(this,arguments)}function _(){return(_=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=2;break}throw new v;case 2:if(n=t.json(),!t.ok){e.next=5;break}return e.abrupt("return",n);case 5:return r="Failed request with status: ".concat(t.status,". ").concat(t.statusText),e.prev=6,e.next=9,n;case 9:i=e.sent,r=i.message?"".concat(r," message: ").concat(i.message):r,r=i.requestId?"".concat(r," request-Id: ").concat(i.requestId):r,e.next=16;break;case 14:e.prev=14,e.t0=e.catch(6);case 16:throw new Error(r);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})))).apply(this,arguments)}var w=new Map,k=g("companionHeaders"),Z=g("getUrl"),O=g("request"),P=function(e){function t(e,n){(0,u.Z)(this,t),Object.defineProperty(this,O,{value:E}),Object.defineProperty(this,Z,{value:S}),Object.defineProperty(this,k,{writable:!0,value:void 0}),this.uppy=e,this.opts=n,this.onReceiveResponse=this.onReceiveResponse.bind(this),y(this,k)[k]=null==n?void 0:n.companionHeaders}return(0,l.Z)(t,[{key:"setCompanionHeaders",value:function(e){y(this,k)[k]=e}},{key:e,value:function(){return y(this,k)[k]}},{key:"hostname",get:function(){var e=this.uppy.getState().companion,t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}},{key:"headers",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client=".concat(t.VERSION)},e.abrupt("return",(0,a.Z)((0,a.Z)({},n),y(this,k)[k]));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onReceiveResponse",value:function(e){var t=e.headers,n=this.uppy.getState().companion||{},r=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==n[r]&&this.uppy.setState({companion:(0,a.Z)((0,a.Z)({},n),{},(0,o.Z)({},r,t.get("i-am")))})}},{key:"preflight",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,i,o=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=w.get(this.hostname))){e.next=3;break}return e.abrupt("return",n);case 3:return r=["accept","content-type","uppy-auth-token"],i=(0,c.Z)((0,s.Z)().mark((function e(){var n,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(y(o,Z)[Z](t),{method:"OPTIONS"});case 3:if(n=e.sent,null!=(i=n.headers.get("access-control-allow-headers"))&&"*"!==i){e.next=8;break}return w.set(o.hostname,r),e.abrupt("return",r);case 8:return o.uppy.log("[CompanionClient] adding allowed preflight headers to companion cache: ".concat(o.hostname," ").concat(i)),a=i.split(",").map((function(e){return e.trim().toLowerCase()})),w.set(o.hostname,a),e.abrupt("return",a);case 14:return e.prev=14,e.t0=e.catch(0),o.uppy.log("[CompanionClient] unable to make preflight request ".concat(e.t0),"warning"),w.delete(o.hostname),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})))(),w.set(this.hostname,i),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"preflightAndHeaders",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,o,a,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.preflight(t),this.headers()]);case 2:return n=e.sent,r=(0,i.Z)(n,2),o=r[0],a=r[1],e.abrupt("return",Object.fromEntries(Object.entries(a).filter((function(e){var t=(0,i.Z)(e,1)[0];return!!o.includes(t.toLowerCase())||(u.uppy.log("[CompanionClient] excluding disallowed header ".concat(t)),!1)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=void 0),"boolean"===typeof n&&(n={skipPostResponse:n}),e.abrupt("return",y(this,O)[O]((0,a.Z)((0,a.Z)({},n),{},{path:t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t,n,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=void 0),"boolean"===typeof r&&(r={skipPostResponse:r}),e.abrupt("return",y(this,O)[O]((0,a.Z)((0,a.Z)({},r),{},{path:t,method:"POST",data:n})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t,n,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=void 0),"boolean"===typeof r&&(r={skipPostResponse:r}),e.abrupt("return",y(this,O)[O]((0,a.Z)((0,a.Z)({},r),{},{path:t,method:"DELETE",data:n})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(Symbol.for("uppy test: getCompanionHeaders"));function S(e){return/^(https?:|)\/\//.test(e)?e:"".concat(this.hostname,"/").concat(e)}function E(e){return x.apply(this,arguments)}function x(){return(x=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,a,u,l,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.path,r=t.method,i=void 0===r?"GET":r,o=t.data,a=t.skipPostResponse,u=t.signal,e.prev=1,e.next=4,this.preflightAndHeaders(n);case 4:return l=e.sent,e.next=7,(0,p.Z)(y(this,Z)[Z](n),{method:i,signal:u,headers:l,credentials:this.opts.companionCookiesRule||"same-origin",body:o?JSON.stringify(o):null});case 7:return c=e.sent,a||this.onReceiveResponse(c),e.abrupt("return",b(c));case 12:if(e.prev=12,e.t0=e.catch(1),null==e.t0||!e.t0.isAuthError){e.next=16;break}throw e.t0;case 16:throw new f.Z("Could not ".concat(i," ").concat(y(this,Z)[Z](n)),{cause:e.t0});case 17:case"end":return e.stop()}}),e,this,[[1,12]])})))).apply(this,arguments)}P.VERSION="3.1.1";var A=n(11752),R=n(61120);function U(e,t){return new Promise((function(n){localStorage.setItem(e,t),n()}))}function j(e){return Promise.resolve(localStorage.getItem(e))}function T(e){return new Promise((function(t){localStorage.removeItem(e),t()}))}var C=function(e){(0,h.Z)(n,e);var t=(0,d.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).provider=r.provider,i.id=i.provider,i.name=i.opts.name||function(e){return e.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}(i.id),i.pluginId=i.opts.pluginId,i.tokenKey="companion-".concat(i.pluginId,"-auth-token"),i.companionKeysParams=i.opts.companionKeysParams,i.preAuthToken=null,i}return(0,l.Z)(n,[{key:"headers",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var t,r,o,u,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,A.Z)((0,R.Z)(n.prototype),"headers",this).call(this),this.getAuthToken()]);case 2:return t=e.sent,r=(0,i.Z)(t,2),o=r[0],u=r[1],l={},u&&(l["uppy-auth-token"]=u),this.companionKeysParams&&(l["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),e.abrupt("return",(0,a.Z)((0,a.Z)({},o),l));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onReceiveResponse",value:function(e){(0,A.Z)((0,R.Z)(n.prototype),"onReceiveResponse",this).call(this,e);var t=this.uppy.getPlugin(this.pluginId),r=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:r}),e}},{key:"setAuthToken",value:function(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}},{key:"getAuthToken",value:function(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}},{key:"ensurePreAuth",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.companionKeysParams||this.preAuthToken){e.next=5;break}return e.next=3,this.fetchPreAuthToken();case 3:if(this.preAuthToken){e.next=5;break}throw new Error("Could not load authentication data required for third-party login. Please try again later.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"authUrl",value:function(e){void 0===e&&(e={});var t=new URLSearchParams(e);return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),"".concat(this.hostname,"/").concat(this.id,"/connect?").concat(t)}},{key:"fileUrl",value:function(e){return"".concat(this.hostname,"/").concat(this.id,"/get/").concat(e)}},{key:"fetchPreAuthToken",value:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.companionKeysParams){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.post("".concat(this.id,"/preauth/"),{params:this.companionKeysParams});case 5:t=e.sent,this.preAuthToken=t.token,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.uppy.log("[CompanionClient] unable to fetch preAuthToken ".concat(e.t0),"warning");case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"list",value:function(e){return this.get("".concat(this.id,"/list/").concat(e||""))}},{key:"logout",value:function(){var e=this;return this.get("".concat(this.id,"/logout")).then((function(t){return Promise.all([t,e.uppy.getPlugin(e.pluginId).storage.removeItem(e.tokenKey)])})).then((function(e){return(0,i.Z)(e,1)[0]}))}}],[{key:"initPlugin",value:function(e,t,n){if(e.type="acquirer",e.files=[],n&&(e.opts=(0,a.Z)((0,a.Z)({},n),t)),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){var i=t.companionAllowedHosts;if("string"!==typeof i&&!Array.isArray(i)&&!(i instanceof RegExp))throw new TypeError("".concat(e.id,': the option "companionAllowedHosts" must be one of string, Array, RegExp'));e.opts.companionAllowedHosts=i}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts="https://".concat(t.companionUrl.replace(/^\/\//,"")):e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||r}}]),n}(P),F=n(15336);function N(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var L=0;function I(e){return"__private_"+L+++"_"+e}var q=I("queued"),B=I("emitter"),D=I("isOpen"),M=I("socket"),z=I("handleMessage"),H=function(e,t){function n(e){var t=this;(0,u.Z)(this,n),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,B,{writable:!0,value:F()}),Object.defineProperty(this,D,{writable:!0,value:!1}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:function(e){try{var n=JSON.parse(e.data);t.emit(n.action,n.payload)}catch(r){console.log(r)}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}return(0,l.Z)(n,[{key:"isOpen",get:function(){return N(this,D)[D]}},{key:e,value:function(){return N(this,M)[M]}},{key:t,value:function(){return N(this,q)[q]}},{key:"open",value:function(){var e=this;N(this,M)[M]=new WebSocket(this.opts.target),N(this,M)[M].onopen=function(){for(N(e,D)[D]=!0;N(e,q)[q].length>0&&N(e,D)[D];){var t=N(e,q)[q].shift();e.send(t.action,t.payload)}},N(this,M)[M].onclose=function(){N(e,D)[D]=!1},N(this,M)[M].onmessage=N(this,z)[z]}},{key:"close",value:function(){var e;null==(e=N(this,M)[M])||e.close()}},{key:"send",value:function(e,t){N(this,D)[D]?N(this,M)[M].send(JSON.stringify({action:e,payload:t})):N(this,q)[q].push({action:e,payload:t})}},{key:"on",value:function(e,t){N(this,B)[B].on(e,t)}},{key:"emit",value:function(e,t){N(this,B)[B].emit(e,t)}},{key:"once",value:function(e,t){N(this,B)[B].once(e,t)}}]),n}(Symbol.for("uppy test: getSocket"),Symbol.for("uppy test: getQueued"))},63798:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(4942),i=n(1413),o=n(15671),s=n(43144),a=n(11885),u=function(){function e(t,n){(0,o.Z)(this,e),void 0===n&&(n={}),this.uppy=t,this.opts=n}return(0,s.Z)(e,[{key:"getPluginState",value:function(){return this.uppy.getState().plugins[this.id]||{}}},{key:"setPluginState",value:function(e){var t=this.uppy.getState().plugins;this.uppy.setState({plugins:(0,i.Z)((0,i.Z)({},t),{},(0,r.Z)({},this.id,(0,i.Z)((0,i.Z)({},t[this.id]),e)))})}},{key:"setOptions",value:function(e){this.opts=(0,i.Z)((0,i.Z)({},this.opts),e),this.setPluginState(),this.i18nInit()}},{key:"i18nInit",value:function(){var e=new a.Z([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}},{key:"addTarget",value:function(){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}},{key:"install",value:function(){}},{key:"uninstall",value:function(){}},{key:"render",value:function(){throw new Error("Extend the render method to add your plugin to a DOM element")}},{key:"update",value:function(){}},{key:"afterUpdate",value:function(){}}]),e}()},50732:function(e,t,n){"use strict";n.d(t,{di:function(){return Te},hS:function(){return ke},ZP:function(){return ke}});var r=n(74165),i=n(15861),o=n(42982),s=n(4942),a=n(1413),u=n(15671),l=n(43144),c=n(11885),p=n(15336),f="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",h=n(33881);function d(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var v=0;function y(e){return"__private_"+v+++"_"+e}var m=y("callbacks"),g=y("publish"),b=function(){function e(){(0,u.Z)(this,e),Object.defineProperty(this,g,{value:_}),Object.defineProperty(this,m,{writable:!0,value:new Set}),this.state={}}return(0,l.Z)(e,[{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){var t=(0,a.Z)({},this.state),n=(0,a.Z)((0,a.Z)({},this.state),e);this.state=n,d(this,g)[g](t,n,e)}},{key:"subscribe",value:function(e){var t=this;return d(this,m)[m].add(e),function(){d(t,m)[m].delete(e)}}}]),e}();function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];d(this,m)[m].forEach((function(e){e.apply(void 0,t)}))}b.VERSION="3.0.2";var w=b,k=n(53700),Z=n(13377),O=n(68594),P=n(70885);function S(e){if(null==e&&"undefined"!==typeof navigator&&(e=navigator.userAgent),!e)return!0;var t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;var n=t[1].split("."),r=(0,P.Z)(n,2),i=r[0],o=r[1];return i=parseInt(i,10),o=parseInt(o,10),i<15||15===i&&o<15063||(i>18||18===i&&o>=18218)}function E(e){return e<10?"0".concat(e):e.toString()}function x(){var e=new Date,t=E(e.getHours()),n=E(e.getMinutes()),r=E(e.getSeconds());return"".concat(t,":").concat(n,":").concat(r)}var A={debug:function(){},warn:function(){},error:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["[Uppy] [".concat(x(),"]")].concat(n))}},R={debug:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).debug.apply(e,["[Uppy] [".concat(x(),"]")].concat(n))},warn:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).warn.apply(e,["[Uppy] [".concat(x(),"]")].concat(n))},error:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["[Uppy] [".concat(x(),"]")].concat(n))}},U=n(37762),j=n(60136),T=n(29388),C=n(98737),F=n(39968),N=n(92026),L={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},I=function(e){(0,j.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).isRestriction=!0,e}return(0,l.Z)(n)}((0,C.Z)(Error)),q=function(){function e(t,n){(0,u.Z)(this,e),this.i18n=n,this.getOpts=function(){var e=t();if(null!=e.restrictions.allowedFileTypes&&!Array.isArray(e.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return e}}return(0,l.Z)(e,[{key:"validate",value:function(e,t){var n=this.getOpts().restrictions,r=n.maxFileSize,i=n.minFileSize,o=n.maxTotalFileSize,s=n.maxNumberOfFiles,a=n.allowedFileTypes;if(s&&t.filter((function(e){return!e.isGhost})).length+1>s)throw new I("".concat(this.i18n("youCanOnlyUploadX",{smart_count:s})));if(a&&!a.some((function(t){return t.includes("/")?!!e.type&&N(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()}))){var u=a.join(", ");throw new I(this.i18n("youCanOnlyUploadFileTypes",{types:u}))}if(o&&null!=e.size&&t.reduce((function(e,t){return e+t.size}),e.size)>o)throw new I(this.i18n("exceedsSize",{size:F(o),file:e.name}));if(r&&null!=e.size&&e.size>r)throw new I(this.i18n("exceedsSize",{size:F(r),file:e.name}));if(i&&null!=e.size&&e.size<i)throw new I(this.i18n("inferiorSize",{size:F(i)}))}},{key:"validateMinNumberOfFiles",value:function(e){var t=this.getOpts().restrictions.minNumberOfFiles;if(Object.keys(e).length<t)throw new I(this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))}},{key:"getMissingRequiredMetaFields",value:function(e){var t,n=new I(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),r=this.getOpts().restrictions.requiredMetaFields,i=[],o=(0,U.Z)(r);try{for(o.s();!(t=o.n()).done;){var s=t.value;Object.hasOwn(e.meta,s)&&""!==e.meta[s]||i.push(s)}}catch(a){o.e(a)}finally{o.f()}return{missingFields:i,error:n}}}]),e}(),B={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",emptyFolderAdded:"No files were added from empty folder",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}};function D(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var M=0;function z(e){return"__private_"+M+++"_"+e}var H=z("plugins"),W=z("restricter"),V=z("storeUnsubscribe"),K=z("emitter"),Y=z("preProcessors"),$=z("uploaders"),G=z("postProcessors"),J=z("informAndEmit"),X=z("checkRequiredMetaFieldsOnFile"),Q=z("checkRequiredMetaFields"),ee=z("assertNewUploadAllowed"),te=z("checkAndCreateFileStateObject"),ne=z("startIfAutoProceed"),re=z("addListeners"),ie=z("updateOnlineStatus"),oe=z("createUpload"),se=z("getUpload"),ae=z("removeUpload"),ue=z("runUpload"),le=function(e,t){function n(e){var t=this;(0,u.Z)(this,n),Object.defineProperty(this,ue,{value:_e}),Object.defineProperty(this,ae,{value:be}),Object.defineProperty(this,se,{value:ge}),Object.defineProperty(this,oe,{value:me}),Object.defineProperty(this,re,{value:ye}),Object.defineProperty(this,ne,{value:ve}),Object.defineProperty(this,te,{value:de}),Object.defineProperty(this,ee,{value:he}),Object.defineProperty(this,Q,{value:fe}),Object.defineProperty(this,X,{value:pe}),Object.defineProperty(this,J,{value:ce}),Object.defineProperty(this,H,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,K,{writable:!0,value:p()}),Object.defineProperty(this,Y,{writable:!0,value:new Set}),Object.defineProperty(this,$,{writable:!0,value:new Set}),Object.defineProperty(this,G,{writable:!0,value:new Set}),Object.defineProperty(this,ie,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=B;var r={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:L,meta:{},onBeforeFileAdded:function(e){return e},onBeforeUpload:function(e){return e},store:new w,logger:A,infoTimeout:5e3};this.opts=(0,a.Z)((0,a.Z)((0,a.Z)({},r),e),{},{restrictions:(0,a.Z)((0,a.Z)({},r.restrictions),e&&e.restrictions)}),e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=R),this.log("Using Core v".concat(this.constructor.VERSION)),this.i18nInit(),this.calculateProgress=h(this.calculateProgress.bind(this),500,{leading:!0,trailing:!0}),this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:S(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:(0,a.Z)({},this.opts.meta),info:[],recoveredState:null}),D(this,W)[W]=new q((function(){return t.opts}),this.i18n),D(this,V)[V]=this.store.subscribe((function(e,n,r){t.emit("state-update",e,n,r),t.updateAll(n)})),this.opts.debug&&"undefined"!==typeof window&&(window[this.opts.id]=this),D(this,re)[re]()}return(0,l.Z)(n,[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=D(this,K)[K]).emit.apply(t,[e].concat(r))}},{key:"on",value:function(e,t){return D(this,K)[K].on(e,t),this}},{key:"once",value:function(e,t){return D(this,K)[K].once(e,t),this}},{key:"off",value:function(e,t){return D(this,K)[K].off(e,t),this}},{key:"updateAll",value:function(e){this.iteratePlugins((function(t){t.update(e)}))}},{key:"setState",value:function(e){this.store.setState(e)}},{key:"getState",value:function(){return this.store.getState()}},{key:"setFileState",value:function(e,t){if(!this.getState().files[e])throw new Error("Can\u2019t set state for ".concat(e," (the file could have been removed)"));this.setState({files:(0,a.Z)((0,a.Z)({},this.getState().files),{},(0,s.Z)({},e,(0,a.Z)((0,a.Z)({},this.getState().files[e]),t)))})}},{key:"i18nInit",value:function(){var e=new c.Z([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}},{key:"setOptions",value:function(e){this.opts=(0,a.Z)((0,a.Z)((0,a.Z)({},this.opts),e),{},{restrictions:(0,a.Z)((0,a.Z)({},this.opts.restrictions),e&&e.restrictions)}),e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((function(e){e.setOptions()})),this.setState()}},{key:"resetProgress",value:function(){var e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t=(0,a.Z)({},this.getState().files),n={};Object.keys(t).forEach((function(r){var i=(0,a.Z)({},t[r]);i.progress=(0,a.Z)((0,a.Z)({},i.progress),e),n[r]=i})),this.setState({files:n,totalProgress:0}),this.emit("reset-progress")}},{key:"addPreProcessor",value:function(e){D(this,Y)[Y].add(e)}},{key:"removePreProcessor",value:function(e){return D(this,Y)[Y].delete(e)}},{key:"addPostProcessor",value:function(e){D(this,G)[G].add(e)}},{key:"removePostProcessor",value:function(e){return D(this,G)[G].delete(e)}},{key:"addUploader",value:function(e){D(this,$)[$].add(e)}},{key:"removeUploader",value:function(e){return D(this,$)[$].delete(e)}},{key:"setMeta",value:function(e){var t=(0,a.Z)((0,a.Z)({},this.getState().meta),e),n=(0,a.Z)({},this.getState().files);Object.keys(n).forEach((function(t){n[t]=(0,a.Z)((0,a.Z)({},n[t]),{},{meta:(0,a.Z)((0,a.Z)({},n[t].meta),e)})})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:n})}},{key:"setFileMeta",value:function(e,t){var n=(0,a.Z)({},this.getState().files);if(n[e]){var r=(0,a.Z)((0,a.Z)({},n[e].meta),t);n[e]=(0,a.Z)((0,a.Z)({},n[e]),{},{meta:r}),this.setState({files:n})}else this.log("Was trying to set metadata for a file that has been removed: ",e)}},{key:"getFile",value:function(e){return this.getState().files[e]}},{key:"getFiles",value:function(){var e=this.getState().files;return Object.values(e)}},{key:"getObjectOfFilesPerState",value:function(){var e=this.getState(),t=e.files,n=e.totalProgress,r=e.error,i=Object.values(t),o=i.filter((function(e){var t=e.progress;return!t.uploadComplete&&t.uploadStarted})),s=i.filter((function(e){return!e.progress.uploadStarted})),a=i.filter((function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess})),u=i.filter((function(e){return e.progress.uploadStarted})),l=i.filter((function(e){return e.isPaused})),c=i.filter((function(e){return e.progress.uploadComplete})),p=i.filter((function(e){return e.error})),f=o.filter((function(e){return!e.isPaused})),h=i.filter((function(e){return e.progress.preprocess||e.progress.postprocess}));return{newFiles:s,startedFiles:a,uploadStartedFiles:u,pausedFiles:l,completeFiles:c,erroredFiles:p,inProgressFiles:o,inProgressNotPausedFiles:f,processingFiles:h,isUploadStarted:u.length>0,isAllComplete:100===n&&c.length===i.length&&0===h.length,isAllErrored:!!r&&p.length===i.length,isAllPaused:0!==o.length&&l.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:i.some((function(e){return e.isGhost}))}}},{key:"validateRestrictions",value:function(e,t){void 0===t&&(t=this.getFiles());try{D(this,W)[W].validate(e,t)}catch(n){return n}return null}},{key:"checkIfFileAlreadyExists",value:function(e){var t=this.getState().files;return!(!t[e]||t[e].isGhost)}},{key:"addFile",value:function(e){D(this,ee)[ee](e);var t=this.getState().files,n=D(this,te)[te](t,e);return t[n.id]&&t[n.id].isGhost&&(n=(0,a.Z)((0,a.Z)({},t[n.id]),{},{data:e.data,isGhost:!1}),this.log("Replaced the blob in the restored ghost file: ".concat(n.name,", ").concat(n.id))),this.setState({files:(0,a.Z)((0,a.Z)({},t),{},(0,s.Z)({},n.id,n))}),this.emit("file-added",n),this.emit("files-added",[n]),this.log("Added file: ".concat(n.name,", ").concat(n.id,", mime type: ").concat(n.type)),D(this,ne)[ne](),n.id}},{key:"addFiles",value:function(e){var t=this;D(this,ee)[ee]();for(var n=(0,a.Z)({},this.getState().files),r=[],i=[],o=0;o<e.length;o++)try{var s=D(this,te)[te](n,e[o]);n[s.id]&&n[s.id].isGhost&&(s=(0,a.Z)((0,a.Z)({},n[s.id]),{},{data:e[o].data,isGhost:!1}),this.log("Replaced blob in a ghost file: ".concat(s.name,", ").concat(s.id))),n[s.id]=s,r.push(s)}catch(l){l.isRestriction||i.push(l)}if(this.setState({files:n}),r.forEach((function(e){t.emit("file-added",e)})),this.emit("files-added",r),r.length>5?this.log("Added batch of ".concat(r.length," files")):Object.keys(r).forEach((function(e){t.log("Added file: ".concat(r[e].name,"\n id: ").concat(r[e].id,"\n type: ").concat(r[e].type))})),r.length>0&&D(this,ne)[ne](),i.length>0){var u="Multiple errors occurred while adding files:\n";if(i.forEach((function(e){u+="\n * ".concat(e.message)})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:i.length}),details:u},"error",this.opts.infoTimeout),"function"===typeof AggregateError)throw new AggregateError(i,u);var l=new Error(u);throw l.errors=i,l}}},{key:"removeFiles",value:function(e,t){var n=this,r=this.getState(),i=r.files,o=r.currentUploads,s=(0,a.Z)({},i),u=(0,a.Z)({},o),l=Object.create(null);function c(e){return void 0===l[e]}e.forEach((function(e){i[e]&&(l[e]=i[e],delete s[e])})),Object.keys(u).forEach((function(e){var t=o[e].fileIDs.filter(c);if(0!==t.length){var r=n.getState().capabilities;if(t.length!==o[e].fileIDs.length&&!r.individualCancellation)throw new Error("individualCancellation is disabled");u[e]=(0,a.Z)((0,a.Z)({},o[e]),{},{fileIDs:t})}else delete u[e]}));var p={currentUploads:u,files:s};0===Object.keys(s).length&&(p.allowNewUpload=!0,p.error=null,p.recoveredState=null),this.setState(p),this.calculateTotalProgress();var f=Object.keys(l);f.forEach((function(e){n.emit("file-removed",l[e],t)})),f.length>5?this.log("Removed ".concat(f.length," files")):this.log("Removed files: ".concat(f.join(", ")))}},{key:"removeFile",value:function(e,t){void 0===t&&(t=null),this.removeFiles([e],t)}},{key:"pauseResume",value:function(e){if(this.getState().capabilities.resumableUploads&&!this.getFile(e).uploadComplete){var t=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}}},{key:"pauseAll",value:function(){var e=(0,a.Z)({},this.getState().files);Object.keys(e).filter((function(t){return!e[t].progress.uploadComplete&&e[t].progress.uploadStarted})).forEach((function(t){var n=(0,a.Z)((0,a.Z)({},e[t]),{},{isPaused:!0});e[t]=n})),this.setState({files:e}),this.emit("pause-all")}},{key:"resumeAll",value:function(){var e=(0,a.Z)({},this.getState().files);Object.keys(e).filter((function(t){return!e[t].progress.uploadComplete&&e[t].progress.uploadStarted})).forEach((function(t){var n=(0,a.Z)((0,a.Z)({},e[t]),{},{isPaused:!1,error:null});e[t]=n})),this.setState({files:e}),this.emit("resume-all")}},{key:"retryAll",value:function(){var e=(0,a.Z)({},this.getState().files),t=Object.keys(e).filter((function(t){return e[t].error}));if(t.forEach((function(t){var n=(0,a.Z)((0,a.Z)({},e[t]),{},{isPaused:!1,error:null});e[t]=n})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});var n=D(this,oe)[oe](t,{forceAllowNewUpload:!0});return D(this,ue)[ue](n)}},{key:"cancelAll",value:function(e){var t=(void 0===e?{}:e).reason,n=void 0===t?"user":t;if(this.emit("cancel-all",{reason:n}),"user"===n){var r=this.getState().files,i=Object.keys(r);i.length&&this.removeFiles(i,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})}}},{key:"retryUpload",value:function(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);var t=D(this,oe)[oe]([e],{forceAllowNewUpload:!0});return D(this,ue)[ue](t)}},{key:"logout",value:function(){this.iteratePlugins((function(e){e.provider&&e.provider.logout&&e.provider.logout()}))}},{key:"calculateProgress",value:function(e,t){if(null!=e&&this.getFile(e.id)){var n=Number.isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:(0,a.Z)((0,a.Z)({},this.getFile(e.id).progress),{},{bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:n?Math.round(t.bytesUploaded/t.bytesTotal*100):0})}),this.calculateTotalProgress()}else this.log("Not setting progress for a file that has been removed: ".concat(null==e?void 0:e.id))}},{key:"calculateTotalProgress",value:function(){var e=this.getFiles().filter((function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess}));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});var t=e.filter((function(e){return null!=e.progress.bytesTotal})),n=e.filter((function(e){return null==e.progress.bytesTotal}));if(0!==t.length){var r=t.reduce((function(e,t){return e+t.progress.bytesTotal}),0),i=r/t.length;r+=i*n.length;var o=0;t.forEach((function(e){o+=e.progress.bytesUploaded})),n.forEach((function(e){o+=i*(e.progress.percentage||0)/100}));var s=0===r?0:Math.round(o/r*100);s>100&&(s=100),this.setState({totalProgress:s}),this.emit("progress",s)}else{var a=100*e.length,u=n.reduce((function(e,t){return e+t.progress.percentage}),0),l=Math.round(u/a*100);this.setState({totalProgress:l})}}},{key:"updateOnlineStatus",value:function(){"undefined"===typeof window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}},{key:"getID",value:function(){return this.opts.id}},{key:"use",value:function(e,t){if("function"!==typeof e){var n="Expected a plugin class, but got ".concat(null===e?"null":typeof e,".")+" Please verify that the plugin was imported and spelled correctly.";throw new TypeError(n)}var r=new e(this,t),i=r.id;if(!i)throw new Error("Your plugin must have an id");if(!r.type)throw new Error("Your plugin must have a type");var o=this.getPlugin(i);if(o){var s="Already found a plugin named '".concat(o.id,"'. ")+"Tried to use: '".concat(i,"'.\n")+"Uppy plugins must have unique `id` options. See https://uppy.io/docs/plugins/#id.";throw new Error(s)}return e.VERSION&&this.log("Using ".concat(i," v").concat(e.VERSION)),r.type in D(this,H)[H]?D(this,H)[H][r.type].push(r):D(this,H)[H][r.type]=[r],r.install(),this}},{key:"getPlugin",value:function(e){for(var t=0,n=Object.values(D(this,H)[H]);t<n.length;t++){var r=n[t].find((function(t){return t.id===e}));if(null!=r)return r}}},{key:e,value:function(e){return D(this,H)[H][e]}},{key:"iteratePlugins",value:function(e){Object.values(D(this,H)[H]).flat(1).forEach(e)}},{key:"removePlugin",value:function(e){this.log("Removing plugin ".concat(e.id)),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();var t=D(this,H)[H][e.type],n=t.findIndex((function(t){return t.id===e.id}));-1!==n&&t.splice(n,1);var r=this.getState(),i={plugins:(0,a.Z)((0,a.Z)({},r.plugins),{},(0,s.Z)({},e.id,void 0))};this.setState(i)}},{key:"close",value:function(e){var t=this,n=(void 0===e?{}:e).reason;this.log("Closing Uppy instance ".concat(this.opts.id,": removing all files and uninstalling plugins")),this.cancelAll({reason:n}),D(this,V)[V](),this.iteratePlugins((function(e){t.removePlugin(e)})),"undefined"!==typeof window&&window.removeEventListener&&(window.removeEventListener("online",D(this,ie)[ie]),window.removeEventListener("offline",D(this,ie)[ie]))}},{key:"hideInfo",value:function(){var e=this.getState().info;this.setState({info:e.slice(1)}),this.emit("info-hidden")}},{key:"info",value:function(e,t,n){var r=this;void 0===t&&(t="info"),void 0===n&&(n=3e3);var i="object"===typeof e;this.setState({info:[].concat((0,o.Z)(this.getState().info),[{type:t,message:i?e.message:e,details:i?e.details:null}])}),setTimeout((function(){return r.hideInfo()}),n),this.emit("info-visible")}},{key:"log",value:function(e,t){var n=this.opts.logger;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e)}}},{key:"restore",value:function(e){return this.log('Core: attempting to restore upload "'.concat(e,'"')),this.getState().currentUploads[e]?D(this,ue)[ue](e):(D(this,ae)[ae](e),Promise.reject(new Error("Nonexistent upload")))}},{key:t,value:function(){var e;return(e=D(this,oe))[oe].apply(e,arguments)}},{key:"addResultData",value:function(e,t){if(D(this,se)[se](e)){var n=this.getState().currentUploads,r=(0,a.Z)((0,a.Z)({},n[e]),{},{result:(0,a.Z)((0,a.Z)({},n[e].result),t)});this.setState({currentUploads:(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,r))})}else this.log("Not setting result for an upload that has been removed: ".concat(e))}},{key:"upload",value:function(){var e,t=this;null!=(e=D(this,H)[H].uploader)&&e.length||this.log("No uploader type plugins are used","warning");var n=this.getState().files,r=this.opts.onBeforeUpload(n);return!1===r?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(r&&"object"===typeof r&&(n=r,this.setState({files:n})),Promise.resolve().then((function(){return D(t,W)[W].validateMinNumberOfFiles(n)})).catch((function(e){throw D(t,J)[J](e),e})).then((function(){if(!D(t,Q)[Q](n))throw new I(t.i18n("missingRequiredMetaField"))})).catch((function(e){throw e})).then((function(){var e=t.getState().currentUploads,r=Object.values(e).flatMap((function(e){return e.fileIDs})),i=[];Object.keys(n).forEach((function(e){var n=t.getFile(e);n.progress.uploadStarted||-1!==r.indexOf(e)||i.push(n.id)}));var o=D(t,oe)[oe](i);return D(t,ue)[ue](o)})).catch((function(e){throw t.emit("error",e),t.log(e,"error"),e})))}}]),n}(Symbol.for("uppy test: getPlugins"),Symbol.for("uppy test: createUpload"));function ce(e,t){var n=e.message,r=e.details,i=void 0===r?"":r;e.isRestriction?this.emit("restriction-failed",t,e):this.emit("error",e),this.info({message:n,details:i},"error",this.opts.infoTimeout),this.log("".concat(n," ").concat(i).trim(),"error")}function pe(e){var t=D(this,W)[W].getMissingRequiredMetaFields(e),n=t.missingFields,r=t.error;return!(n.length>0)||(this.setFileState(e.id,{missingRequiredMetaFields:n}),this.log(r.message),this.emit("restriction-failed",e,r),!1)}function fe(e){for(var t=!0,n=0,r=Object.values(e);n<r.length;n++){var i=r[n];D(this,X)[X](i)||(t=!1)}return t}function he(e){if(!1===this.getState().allowNewUpload){var t=new I(this.i18n("noMoreFilesAllowed"));throw D(this,J)[J](t,e),t}}function de(e,t){t instanceof File&&(t={name:t.name,type:t.type,size:t.size,data:t});var n=(0,k.Z)(t),r=function(e,t){return t.name?t.name:"image"===e.split("/")[0]?"".concat(e.split("/")[0],".").concat(e.split("/")[1]):"noname"}(n,t),i=(0,Z.Z)(r).extension,o=Boolean(t.isRemote),s=(0,O.Z)((0,a.Z)((0,a.Z)({},t),{},{type:n}));if(this.checkIfFileAlreadyExists(s)){var u=new I(this.i18n("noDuplicates",{fileName:r}));throw D(this,J)[J](u,t),u}var l=t.meta||{};l.name=r,l.type=n;var c=Number.isFinite(t.data.size)?t.data.size:null,p={source:t.source||"",id:s,name:r,extension:i||"",meta:(0,a.Z)((0,a.Z)({},this.getState().meta),l),type:n,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:c,uploadComplete:!1,uploadStarted:null},size:c,isRemote:o,remote:t.remote||"",preview:t.preview},f=this.opts.onBeforeFileAdded(p,e);if(!1===f){var h=new I("Cannot add the file because onBeforeFileAdded returned false.");throw this.emit("restriction-failed",t,h),h}"object"===typeof f&&null!==f&&(p=f);try{var d=Object.keys(e).map((function(t){return e[t]}));D(this,W)[W].validate(p,d)}catch(v){throw D(this,J)[J](v,p),v}return p}function ve(){var e=this;this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((function(){e.scheduledAutoProceed=null,e.upload().catch((function(t){t.isRestriction||e.log(t.stack||t.message||t)}))}),4))}function ye(){var e=this,t=function(t,n,r){var i=t.message||"Unknown error";t.details&&(i+=" ".concat(t.details)),e.setState({error:i}),null!=n&&n.id in e.getState().files&&e.setFileState(n.id,{error:i,response:r})};this.on("error",t),this.on("upload-error",(function(n,r,i){if(t(r,n,i),"object"===typeof r&&r.message){var o=new Error(r.message);o.details=r.message,r.details&&(o.details+=" ".concat(r.details)),o.message=e.i18n("failedToUpload",{file:null==n?void 0:n.name}),D(e,J)[J](o)}else D(e,J)[J](r)})),this.on("upload",(function(){e.setState({error:null})})),this.on("upload-started",(function(t){null!=t&&e.getFile(t.id)?e.setFileState(t.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:t.size}}):e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",(function(t,n){if(null!=t&&e.getFile(t.id)){var r=e.getFile(t.id).progress;e.setFileState(t.id,{progress:(0,a.Z)((0,a.Z)({},r),{},{postprocess:D(e,G)[G].size>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:r.bytesTotal}),response:n,uploadURL:n.uploadURL,isPaused:!1}),null==t.size&&e.setFileState(t.id,{size:n.bytesUploaded||r.bytesTotal}),e.calculateTotalProgress()}else e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("preprocess-progress",(function(t,n){null!=t&&e.getFile(t.id)?e.setFileState(t.id,{progress:(0,a.Z)((0,a.Z)({},e.getFile(t.id).progress),{},{preprocess:n})}):e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("preprocess-complete",(function(t){if(null!=t&&e.getFile(t.id)){var n=(0,a.Z)({},e.getState().files);n[t.id]=(0,a.Z)((0,a.Z)({},n[t.id]),{},{progress:(0,a.Z)({},n[t.id].progress)}),delete n[t.id].progress.preprocess,e.setState({files:n})}else e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("postprocess-progress",(function(t,n){null!=t&&e.getFile(t.id)?e.setFileState(t.id,{progress:(0,a.Z)((0,a.Z)({},e.getState().files[t.id].progress),{},{postprocess:n})}):e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("postprocess-complete",(function(t){if(null!=t&&e.getFile(t.id)){var n=(0,a.Z)({},e.getState().files);n[t.id]=(0,a.Z)((0,a.Z)({},n[t.id]),{},{progress:(0,a.Z)({},n[t.id].progress)}),delete n[t.id].progress.postprocess,e.setState({files:n})}else e.log("Not setting progress for a file that has been removed: ".concat(null==t?void 0:t.id))})),this.on("restored",(function(){e.calculateTotalProgress()})),this.on("dashboard:file-edit-complete",(function(t){t&&D(e,X)[X](t)})),"undefined"!==typeof window&&window.addEventListener&&(window.addEventListener("online",D(this,ie)[ie]),window.addEventListener("offline",D(this,ie)[ie]),setTimeout(D(this,ie)[ie],3e3))}function me(e,t){void 0===t&&(t={});var n=t.forceAllowNewUpload,r=void 0!==n&&n,i=this.getState(),o=i.allowNewUpload,u=i.currentUploads;if(!o&&!r)throw new Error("Cannot create a new upload: already uploading.");var l=function(){for(var e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;t--;)e+=f[64*Math.random()|0];return e}();return this.emit("upload",{id:l,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:(0,a.Z)((0,a.Z)({},u),{},(0,s.Z)({},l,{fileIDs:e,step:0,result:{}}))}),l}function ge(e){return this.getState().currentUploads[e]}function be(e){var t=(0,a.Z)({},this.getState().currentUploads);delete t[e],this.setState({currentUploads:t})}function _e(e){return we.apply(this,arguments)}function we(){return(we=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u,l,c,p,f,h,d,v,y,m,g=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.getState(),i=n.currentUploads,u=i[t],l=u.step||0,c=[].concat((0,o.Z)(D(this,Y)[Y]),(0,o.Z)(D(this,$)[$]),(0,o.Z)(D(this,G)[G])),e.prev=4,p=l;case 6:if(!(p<c.length)){e.next=19;break}if(u){e.next=9;break}return e.abrupt("break",19);case 9:return f=c[p],h=(0,a.Z)((0,a.Z)({},u),{},{step:p}),this.setState({currentUploads:(0,a.Z)((0,a.Z)({},i),{},(0,s.Z)({},t,h))}),e.next=14,f(h.fileIDs,t);case 14:i=this.getState().currentUploads,u=i[t];case 16:p++,e.next=6;break;case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(4),D(this,ae)[ae](t),e.t0;case 25:if(!u){e.next=34;break}return u.fileIDs.forEach((function(e){var t=g.getFile(e);t&&t.progress.postprocess&&g.emit("postprocess-complete",t)})),d=u.fileIDs.map((function(e){return g.getFile(e)})),v=d.filter((function(e){return!e.error})),y=d.filter((function(e){return e.error})),e.next=32,this.addResultData(t,{successful:v,failed:y,uploadID:t});case 32:i=this.getState().currentUploads,u=i[t];case 34:return u&&(m=u.result,this.emit("complete",m),D(this,ae)[ae](t)),null==m&&this.log("Not setting result for an upload that has been removed: ".concat(t)),e.abrupt("return",m);case 37:case"end":return e.stop()}}),e,this,[[4,21]])})))).apply(this,arguments)}le.VERSION="3.0.4";var ke=le,Ze=n(97326),Oe=n(58620),Pe=n(8165);var Se=n(4692),Ee=n(63798);function xe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Ae=0;function Re(e){return"__private_"+Ae+++"_"+e}var Ue=Re("updateUI"),je=function(e){(0,j.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;return(0,u.Z)(this,n),e=t.apply(this,arguments),Object.defineProperty((0,Ze.Z)(e),Ue,{writable:!0,value:void 0}),e}return(0,l.Z)(n,[{key:"getTargetPlugin",value:function(e){var t;if("object"===typeof e&&e instanceof n)t=e;else if("function"===typeof e){var r=e;this.uppy.iteratePlugins((function(e){e instanceof r&&(t=e)}))}return t}},{key:"mount",value:function(e,t){var n,r,i=this,s=t.id,a=(n=e,void 0===r&&(r=document),"string"===typeof n?r.querySelector(n):(0,Pe.Z)(n)?n:null);if(a){this.isTargetDOMEl=!0;var u=document.createElement("div");return u.classList.add("uppy-Root"),xe(this,Ue)[Ue]=function(e){var t=null,n=null;return function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=i,t||(t=Promise.resolve().then((function(){return t=null,e.apply(void 0,(0,o.Z)(n))}))),t}}((function(e){i.uppy.getPlugin(i.id)&&((0,Oe.sY)(i.render(e),u),i.afterUpdate())})),this.uppy.log("Installing ".concat(s," to a DOM element '").concat(e,"'")),this.opts.replaceTargetContent&&(a.innerHTML=""),(0,Oe.sY)(this.render(this.uppy.getState()),u),this.el=u,a.appendChild(u),u.dir=this.opts.direction||(0,Se.Z)(u)||"ltr",this.onMount(),this.el}var l=this.getTargetPlugin(e);if(l)return this.uppy.log("Installing ".concat(s," to ").concat(l.id)),this.parent=l,this.el=l.addTarget(t),this.onMount(),this.el;this.uppy.log("Not installing ".concat(s));var c="Invalid target option given to ".concat(s,".");throw c+="function"===typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(c)}},{key:"update",value:function(e){var t,n;null!=this.el&&(null==(t=(n=xe(this,Ue))[Ue])||t.call(n,e))}},{key:"unmount",value:function(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove());this.onUnmount()}},{key:"onMount",value:function(){}},{key:"onUnmount",value:function(){}}]),n}(Ee.Z),Te=je},90031:function(e,t,n){"use strict";n.d(t,{ZP:function(){return Ki}});var r={};n.r(r),n.d(r,{Decoder:function(){return Gn},Encoder:function(){return $n},PacketType:function(){return Kn},protocol:function(){return Yn}});var i=n(42982),o=n(1413),s=n(37762),a=n(70885),u=n(4942),l=n(74165),c=n(15861),p=n(15671),f=n(43144),h=n(97326),d=n(60136),v=n(29388),y=n(27974),m=n(51853);function g(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var b=0;function _(e){return"__private_"+b+++"_"+e}function w(e){return new Error("Cancelled",{cause:e})}function k(e){var t=this;if(null!=e){var n=function(){return t.abort(e.reason)};e.addEventListener("abort",n,{once:!0});var r=function(){e.removeEventListener("abort",n)};this.then(r,r)}return this}var Z=_("activeRequests"),O=_("queuedHandlers"),P=_("paused"),S=_("pauseTimer"),E=_("downLimit"),x=_("upperLimit"),A=_("rateLimitingTimer"),R=_("call"),U=_("queueNext"),j=_("next"),T=_("queue"),C=_("dequeue"),F=_("resume"),N=_("increaseLimit"),L=function(){function e(t){var n=this;(0,p.Z)(this,e),Object.defineProperty(this,C,{value:M}),Object.defineProperty(this,T,{value:D}),Object.defineProperty(this,j,{value:B}),Object.defineProperty(this,U,{value:q}),Object.defineProperty(this,R,{value:I}),Object.defineProperty(this,Z,{writable:!0,value:0}),Object.defineProperty(this,O,{writable:!0,value:[]}),Object.defineProperty(this,P,{writable:!0,value:!1}),Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:1}),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:function(){return n.resume()}}),Object.defineProperty(this,N,{writable:!0,value:function(){if(g(n,P)[P])g(n,A)[A]=setTimeout(g(n,N)[N],0);else{g(n,E)[E]=n.limit,n.limit=Math.ceil((g(n,x)[x]+g(n,E)[E])/2);for(var e=g(n,E)[E];e<=n.limit;e++)g(n,U)[U]();g(n,x)[x]-g(n,E)[E]>3?g(n,A)[A]=setTimeout(g(n,N)[N],2e3):g(n,E)[E]=Math.floor(g(n,E)[E]/2)}}}),this.limit="number"!==typeof t||0===t?1/0:t}return(0,f.Z)(e,[{key:"run",value:function(e,t){return!g(this,P)[P]&&g(this,Z)[Z]<this.limit?g(this,R)[R](e):g(this,T)[T](e,t)}},{key:"wrapPromiseFunction",value:function(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s,a=new Promise((function(r,o){s=n.run((function(){var t,n;try{n=Promise.resolve(e.apply(void 0,i))}catch(a){n=Promise.reject(a)}return n.then((function(e){t?o(t):(s.done(),r(e))}),(function(e){t?o(t):(s.done(),o(e))})),function(e){t=w(e)}}),t)}));return a.abort=function(e){s.abort(e)},a.abortOn=k,a}}},{key:"resume",value:function(){g(this,P)[P]=!1,clearTimeout(g(this,S)[S]);for(var e=0;e<this.limit;e++)g(this,U)[U]()}},{key:"pause",value:function(e){void 0===e&&(e=null),g(this,P)[P]=!0,clearTimeout(g(this,S)[S]),null!=e&&(g(this,S)[S]=setTimeout(g(this,F)[F],e))}},{key:"rateLimit",value:function(e){clearTimeout(g(this,A)[A]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(g(this,x)[x]=this.limit-1,this.limit=g(this,E)[E],g(this,A)[A]=setTimeout(g(this,N)[N],e))}},{key:"isPaused",get:function(){return g(this,P)[P]}}]),e}();function I(e){var t=this;g(this,Z)[Z]+=1;var n,r=!1;try{n=e()}catch(i){throw g(this,Z)[Z]-=1,i}return{abort:function(e){r||(r=!0,g(t,Z)[Z]-=1,n(e),g(t,U)[U]())},done:function(){r||(r=!0,g(t,Z)[Z]-=1,g(t,U)[U]())}}}function q(){var e=this;queueMicrotask((function(){return g(e,j)[j]()}))}function B(){if(!(g(this,P)[P]||g(this,Z)[Z]>=this.limit)&&0!==g(this,O)[O].length){var e=g(this,O)[O].shift(),t=g(this,R)[R](e.fn);e.abort=t.abort,e.done=t.done}}function D(e,t){var n=this;void 0===t&&(t={});var r={fn:e,priority:t.priority||0,abort:function(){g(n,C)[C](r)},done:function(){throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=g(this,O)[O].findIndex((function(e){return r.priority>e.priority}));return-1===i?g(this,O)[O].push(r):g(this,O)[O].splice(i,0,r),r}function M(e){var t=g(this,O)[O].indexOf(e);-1!==t&&g(this,O)[O].splice(t,1)}Symbol("__queue");var z=n(63798),H="function"===typeof btoa,W="function"===typeof Buffer,V=("function"===typeof TextDecoder&&new TextDecoder,"function"===typeof TextEncoder?new TextEncoder:void 0),K=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Y=(function(e){var t={};e.forEach((function(e,n){return t[e]=n}))}(K),String.fromCharCode.bind(String)),$=("function"===typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),function(e){return e.replace(/=/g,"").replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"}))}),G=function(e){for(var t,n,r,i,o="",s=e.length%3,a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");o+=K[(t=n<<16|r<<8|i)>>18&63]+K[t>>12&63]+K[t>>6&63]+K[63&t]}return s?o.slice(0,s-3)+"===".substring(s):o},J=H?function(e){return btoa(e)}:W?function(e){return Buffer.from(e,"binary").toString("base64")}:G,X=W?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,r=e.length;n<r;n+=4096)t.push(Y.apply(null,e.subarray(n,n+4096)));return J(t.join(""))},Q=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?Y(192|t>>>6)+Y(128|63&t):Y(224|t>>>12&15)+Y(128|t>>>6&63)+Y(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return Y(240|t>>>18&7)+Y(128|t>>>12&63)+Y(128|t>>>6&63)+Y(128|63&t)},ee=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,te=function(e){return e.replace(ee,Q)},ne=W?function(e){return Buffer.from(e,"utf8").toString("base64")}:V?function(e){return X(V.encode(e))}:function(e){return J(te(e))},re=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?$(ne(e)):ne(e)},ie=re,oe=n(65915),se=n.n(oe);function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){if(t&&("object"===ae(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pe(e){var t="function"===typeof Map?new Map:void 0;return pe=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return fe(e,arguments,ve(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),de(r,e)},pe(e)}function fe(e,t,n){return fe=he()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&de(i,n.prototype),i},fe.apply(null,arguments)}function he(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function de(e,t){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},de(e,t)}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}var ye=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}(o,e);var t,n,r,i=function(e){var t=he();return function(){var n,r=ve(e);if(t){var i=ve(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ce(this,n)}}(o);function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(le(this,o),(t=i.call(this,e)).originalRequest=r,t.originalResponse=s,t.causingError=n,null!=n&&(e+=", caused by ".concat(n.toString())),null!=r){var a=r.getHeader("X-Request-ID")||"n/a",u=r.getMethod(),l=r.getURL(),c=s?s.getStatus():"n/a",p=s?s.getBody()||"":"n/a";e+=", originated from request (method: ".concat(u,", url: ").concat(l,", response code: ").concat(c,", response text: ").concat(p,", request id: ").concat(a,")")}return t.message=e,t}return t=o,n&&ue(t.prototype,n),r&&ue(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(pe(Error)),me=ye,ge=!1;function be(e){ge&&console.log(e)}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Se={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},Ee=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var t,n,r;return t=e,n=[{key:"findPreviousUploads",value:function(){var e=this;return this.options.fingerprint(this.file,this.options).then((function(t){return e._urlStorage.findUploadsByFingerprint(t)}))}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e=this,t=this.file;if(t)if(this.options.endpoint||this.options.uploadUrl||this.url){var n=this.options.retryDelays;if(null==n||"[object Array]"===Object.prototype.toString.call(n)){if(this.options.parallelUploads>1)for(var r=0,i=["uploadUrl","uploadSize","uploadLengthDeferred"];r<i.length;r++){var o=i[r];if(this.options[o])return void this._emitError(new Error("tus: cannot use the ".concat(o," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(t,this.options).then((function(n){return be(null==n?"No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.":"Calculated fingerprint: ".concat(n)),e._fingerprint=n,e._source?e._source:e.options.fileReader.openFile(t,e.options.chunkSize)})).then((function(t){if(e._source=t,e.options.uploadLengthDeferred)e._size=null;else if(null!=e.options.uploadSize){if(e._size=Number(e.options.uploadSize),Number.isNaN(e._size))return void e._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(e._size=e._source.size,null==e._size)return void e._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));e.options.parallelUploads>1||null!=e._parallelUploadUrls?e._startParallelUpload():e._startSingleUpload()})).catch((function(t){e._emitError(t)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var t,n=this,r=this._size,i=0;this._parallelUploads=[];var o=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,s=null!==(t=this.options.parallelUploadBoundaries)&&void 0!==t?t:function(e,t){for(var n=Math.floor(e/t),r=[],i=0;i<t;i++)r.push({start:n*i,end:n*(i+1)});return r[t-1].end=e,r}(this._source.size,o);this._parallelUploadUrls&&s.forEach((function(e,t){e.uploadUrl=n._parallelUploadUrls[t]||null})),this._parallelUploadUrls=new Array(s.length);var a,u=s.map((function(t,o){var a=0;return n._source.slice(t.start,t.end).then((function(u){var l=u.value;return new Promise((function(u,c){var p=Ze(Ze({},n.options),{},{uploadUrl:t.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:Ze(Ze({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:u,onError:c,onProgress:function(e){i=i-a+e,a=e,n._emitProgress(i,r)},_onUploadUrlAvailable:function(){n._parallelUploadUrls[o]=f.url,n._parallelUploadUrls.filter((function(e){return Boolean(e)})).length===s.length&&n._saveUploadInUrlStorage()}}),f=new e(l,p);f.start(),n._parallelUploads.push(f)}))}))}));Promise.all(u).then((function(){(a=n._openRequest("POST",n.options.endpoint)).setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var e=xe(n.options.metadata);return""!==e&&a.setHeader("Upload-Metadata",e),n._sendRequest(a,null)})).then((function(e){if(Ae(e.getStatus(),200)){var t=e.getHeader("Location");null!=t?(n.url=Te(n.options.endpoint,t),be("Created upload at ".concat(n.url)),n._emitSuccess()):n._emitHttpError(a,e,"tus: invalid or missing Location header")}else n._emitHttpError(a,e,"tus: unexpected response while creating upload")})).catch((function(e){n._emitError(e)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?(be("Resuming upload from previous URL: ".concat(this.url)),void this._resumeUpload()):null!=this.options.uploadUrl?(be("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,void this._resumeUpload()):(be("Creating a new upload"),void this._createUpload())}},{key:"abort",value:function(t){var n=this;return null!=this._parallelUploads&&this._parallelUploads.forEach((function(e){e.abort(t)})),null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?e.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,n,r){this._emitError(new me(n,r,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),je(e,this._retryAttempt,this.options))){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){t.start()}),n))}if("function"!==typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"===typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"===typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,n){"function"===typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,n)}},{key:"_createUpload",value:function(){var e=this;if(this.options.endpoint){var t=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?t.setHeader("Upload-Defer-Length",1):t.setHeader("Upload-Length",this._size);var n,r=xe(this.options.metadata);""!==r&&t.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(t)):n=this._sendRequest(t,null),n.then((function(n){if(Ae(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(e.url=Te(e.options.endpoint,r),be("Created upload at ".concat(e.url)),"function"===typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),0===e._size)return e._emitSuccess(),void e._source.close();e._saveUploadInUrlStorage().then((function(){e.options.uploadDataDuringCreation?e._handleUploadResponse(t,n):(e._offset=0,e._performUpload())}))}else e._emitHttpError(t,n,"tus: invalid or missing Location header")}else e._emitHttpError(t,n,"tus: unexpected response while creating upload")})).catch((function(n){e._emitHttpError(t,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var e=this,t=this._openRequest("HEAD",this.url);this._sendRequest(t,null).then((function(n){var r=n.getStatus();if(!Ae(r,200))return 423===r?void e._emitHttpError(t,n,"tus: upload is currently locked; retry later"):(Ae(r,400)&&e._removeFromUrlStorage(),e.options.endpoint?(e.url=null,void e._createUpload()):void e._emitHttpError(t,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var i=parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(i))e._emitHttpError(t,n,"tus: invalid or missing offset value");else{var o=parseInt(n.getHeader("Upload-Length"),10);!Number.isNaN(o)||e.options.uploadLengthDeferred?("function"===typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),e._saveUploadInUrlStorage().then((function(){if(i===o)return e._emitProgress(o,o),void e._emitSuccess();e._offset=i,e._performUpload()}))):e._emitHttpError(t,n,"tus: invalid or missing length value")}})).catch((function(n){e._emitHttpError(t,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var e,t=this;this._aborted||(this.options.overridePatchMethod?(e=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):e=this._openRequest("PATCH",this.url),e.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(e).then((function(n){Ae(n.getStatus(),200)?t._handleUploadResponse(e,n):t._emitHttpError(e,n,"tus: unexpected response while uploading chunk")})).catch((function(n){t._aborted||t._emitHttpError(e,null,"tus: failed to upload chunk at offset ".concat(t._offset),n)})))}},{key:"_addChunkToRequest",value:function(e){var t=this,n=this._offset,r=this._offset+this.options.chunkSize;return e.setProgressHandler((function(e){t._emitProgress(n+e,t._size)})),e.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,i=n.done;return t.options.uploadLengthDeferred&&i&&(t._size=t._offset+(r&&r.size?r.size:0),e.setHeader("Upload-Length",t._size)),null===r?t._sendRequest(e):(t._emitProgress(t._offset,t._size),t._sendRequest(e,r))}))}},{key:"_handleUploadResponse",value:function(e,t){var n=parseInt(t.getHeader("Upload-Offset"),10);if(Number.isNaN(n))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n===this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){var n=Re(e,t,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var e=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(t){e._emitError(t)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var t={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?t.parallelUploadUrls=this._parallelUploadUrls:t.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,t).then((function(t){e._urlStorageKey=t}))}},{key:"_sendRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ue(e,t,this.options)}}],r=[{key:"terminate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Re("DELETE",t,n);return Ue(r,null,n).then((function(e){if(204!==e.getStatus())throw new me("tus: unexpected response while terminating upload",null,r,e)})).catch((function(i){if(i instanceof me||(i=new me("tus: failed to terminate upload",i,r,null)),!je(i,0,n))throw i;var o=n.retryDelays[0],s=n.retryDelays.slice(1),a=Ze(Ze({},n),{},{retryDelays:s});return new Promise((function(e){return setTimeout(e,o)})).then((function(){return e.terminate(t,a)}))}))}}],n&&Pe(t.prototype,n),r&&Pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xe(e){return Object.entries(e).map((function(e){var t=_e(e,2),n=t[0],r=t[1];return"".concat(n," ").concat(ie(String(r)))})).join(",")}function Ae(e,t){return e>=t&&e<t+100}function Re(e,t,n){var r=n.httpStack.createRequest(e,t);r.setHeader("Tus-Resumable","1.0.0");var i=n.headers||{};if(Object.entries(i).forEach((function(e){var t=_e(e,2),n=t[0],i=t[1];r.setHeader(n,i)})),n.addRequestId){var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));r.setHeader("X-Request-ID",o)}return r}function Ue(e,t,n){return("function"===typeof n.onBeforeRequest?Promise.resolve(n.onBeforeRequest(e)):Promise.resolve()).then((function(){return e.send(t).then((function(t){return("function"===typeof n.onAfterResponse?Promise.resolve(n.onAfterResponse(e,t)):Promise.resolve()).then((function(){return t}))}))}))}function je(e,t,n){if(null==n.retryDelays||t>=n.retryDelays.length||null==e.originalRequest)return!1;if(n&&"function"===typeof n.onShouldRetry)return n.onShouldRetry(e,t,n);var r=e.originalResponse?e.originalResponse.getStatus():0;return(!Ae(r,400)||409===r||423===r)&&function(){var e=!0;return"undefined"!==typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(e=!1),e}()}function Te(e,t){return new(se())(t,e).toString()}Ee.defaultOptions=Se;var Ce=Ee;function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}])&&Fe(t.prototype,n),r&&Fe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ie=!1;try{Ie="localStorage"in window;var qe="tusSupport";localStorage.setItem(qe,localStorage.getItem(qe))}catch(ao){if(ao.code!==ao.SECURITY_ERR&&ao.code!==ao.QUOTA_EXCEEDED_ERR)throw ao;Ie=!1}var Be=Ie,De=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){var t=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(t)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var n=Math.round(1e12*Math.random()),r="tus::".concat(e,"::").concat(n);return localStorage.setItem(r,JSON.stringify(t)),Promise.resolve(r)}},{key:"_findEntries",value:function(e){for(var t=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(e))try{var i=JSON.parse(localStorage.getItem(r));i.urlStorageKey=r,t.push(i)}catch(ao){}}return t}}],n&&Le(t.prototype,n),r&&Le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t,n){return t&&ze(e.prototype,t),n&&ze(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var We=function(){function e(){Me(this,e)}return He(e,[{key:"createRequest",value:function(e,t){return new Ve(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),Ve=function(){function e(t,n){Me(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,n,!0),this._method=t,this._url=n,this._headers={}}return He(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(e){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(t){t.lengthComputable&&e(t.loaded)})}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){e._xhr.onload=function(){n(new Ke(e._xhr))},e._xhr.onerror=function(e){r(e)},e._xhr.send(t)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),Ke=function(){function e(t){Me(this,e),this._xhr=t}return He(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),Ye=function(){return"undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};var $e=function(){return"undefined"!==typeof window&&("undefined"!==typeof window.PhoneGap||"undefined"!==typeof window.Cordova||"undefined"!==typeof window.cordova)};function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Je=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._file=t,this.size=t.size}var t,n,r;return t=e,n=[{key:"slice",value:function(e,t){if($e())return n=this._file.slice(e,t),new Promise((function(e,t){var r=new FileReader;r.onload=function(){var t=new Uint8Array(r.result);e({value:t})},r.onerror=function(e){t(e)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(e,t);return Promise.resolve({value:r})}},{key:"close",value:function(){}}],n&&Ge(t.prototype,n),r&&Ge(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e){return void 0===e?0:void 0!==e.size?e.size:e.length}var et=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}var t,n,r;return t=e,n=[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(e,t){var n=this,r=t<=this._bufferOffset+Qe(this._buffer);if(this._done||r){var i=this._getDataFromBuffer(e,t),o=null==i&&this._done;return Promise.resolve({value:i,done:o})}return this._reader.read().then((function(r){var i=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=i:n._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}throw new Error("Unknown data type")}(n._buffer,i),n._readUntilEnoughDataOrDone(e,t)}))}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var n=0===Qe(this._buffer);return this._done&&n?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}],n&&Xe(t.prototype,n),r&&Xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"openFile",value:function(e,t){return Ye()&&e&&"undefined"!==typeof e.uri?(n=e.uri,new Promise((function(e,t){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var t=r.response;e(t)},r.onerror=function(e){t(e)},r.open("GET",n),r.send()}))).then((function(e){return new Je(e)})).catch((function(e){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(e))})):"function"===typeof e.slice&&"undefined"!==typeof e.size?Promise.resolve(new Je(e)):"function"===typeof e.read?(t=Number(t),Number.isFinite(t)?Promise.resolve(new et(e,t)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var n}}])&&tt(t.prototype,n),r&&tt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e,t){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},st(e,t)}function at(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ao){return!1}}();return function(){var n,r=lt(e);if(t){var i=lt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ut(this,n)}}function ut(e,t){if(t&&("object"===rt(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function lt(e){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lt(e)}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ht=pt(pt({},Ce.defaultOptions),{},{httpStack:new We,fileReader:new nt,urlStorage:Be?new De:new Ne,fingerprint:function(e,t){return Ye()?Promise.resolve(function(e,t){var n=e.exif?function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",n,t.endpoint].join("/")}(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}}),dt=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&st(e,t)}(o,e);var t,n,r,i=at(o);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return it(this,o),t=pt(pt({},ht),t),i.call(this,e,t)}return t=o,r=[{key:"terminate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=pt(pt({},ht),t),Ce.terminate(e,t)}}],(n=null)&&ot(t.prototype,n),r&&ot(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Ce),vt=window,yt=vt.XMLHttpRequest,mt=vt.Blob,gt=(yt&&mt&&mt.prototype.slice,n(97657));var bt=n(33881)((function(e,t,n){var r=t.progress,i=t.bytesUploaded,o=t.bytesTotal;r&&(e.uppy.log("Upload progress: ".concat(r)),e.uppy.emit("upload-progress",n,{uploader:e,bytesUploaded:i,bytesTotal:o}))}),300,{leading:!0,trailing:!0});function _t(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var wt=0;function kt(e){return"__private_"+wt+++"_"+e}var Zt=kt("emitter"),Ot=kt("events"),Pt=function(){function e(t){(0,p.Z)(this,e),Object.defineProperty(this,Zt,{writable:!0,value:void 0}),Object.defineProperty(this,Ot,{writable:!0,value:[]}),_t(this,Zt)[Zt]=t}return(0,f.Z)(e,[{key:"on",value:function(e,t){return _t(this,Ot)[Ot].push([e,t]),_t(this,Zt)[Zt].on(e,t)}},{key:"remove",value:function(){var e,t=(0,s.Z)(_t(this,Ot)[Ot].splice(0));try{for(t.s();!(e=t.n()).done;){var n=(0,a.Z)(e.value,2),r=n[0],i=n[1];_t(this,Zt)[Zt].off(r,i)}}catch(o){t.e(o)}finally{t.f()}}}]),e}(),St=n(61359);var Et=function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)};function xt(e){return function(t,n){if("undefined"!==typeof window&&("undefined"!==typeof window.PhoneGap||"undefined"!==typeof window.Cordova||"undefined"!==typeof window.cordova)||"undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return ht.fingerprint(t,n);var r=["tus",e.id,n.endpoint].join("-");return Promise.resolve(r)}}function At(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Rt=0;function Ut(e){return"__private_"+Rt+++"_"+e}var jt={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},Tt=Ut("retryDelayIterator"),Ct=Ut("queueRequestSocketToken"),Ft=Ut("requestSocketToken"),Nt=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){var i,s,a;(0,p.Z)(this,n),i=t.call(this,e,r),Object.defineProperty((0,h.Z)(i),Tt,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),Ct,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),Ft,{writable:!0,value:function(){var e=(0,c.Z)((0,l.Z)().mark((function e(t){var n,r,s,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.remote.providerOptions.provider?gt.zt:gt.C$,r=new n(i.uppy,t.remote.providerOptions),s=(0,o.Z)({},i.opts),t.tus&&Object.assign(s,t.tus),e.next=6,r.post(t.remote.url,(0,o.Z)((0,o.Z)({},t.remote.body),{},{endpoint:s.endpoint,uploadUrl:s.uploadUrl,protocol:"tus",size:t.data.size,headers:s.headers,metadata:t.meta}));case 6:return a=e.sent,e.abrupt("return",a.token);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),i.type="uploader",i.id=i.opts.id||"Tus",i.title="Tus";var u={useFastRemoteRetry:!0,limit:20,retryDelays:jt.retryDelays,withCredentials:!1};if(i.opts=(0,o.Z)((0,o.Z)({},u),r),void 0===(null==r?void 0:r.allowedMetaFields)&&"metaFields"in i.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in r)throw new Error("The `autoRetry` option was deprecated and has been removed.");return i.requests=null!=(s=i.opts.rateLimitedQueue)?s:new L(i.opts.limit),At((0,h.Z)(i),Tt)[Tt]=null==(a=i.opts.retryDelays)?void 0:a.values(),i.uploaders=Object.create(null),i.uploaderEvents=Object.create(null),i.uploaderSockets=Object.create(null),i.handleResetProgress=i.handleResetProgress.bind((0,h.Z)(i)),i.handleUpload=i.handleUpload.bind((0,h.Z)(i)),At((0,h.Z)(i),Ct)[Ct]=i.requests.wrapPromiseFunction(At((0,h.Z)(i),Ft)[Ft],{priority:-1}),i}return(0,f.Z)(n,[{key:"handleResetProgress",value:function(){var e=(0,o.Z)({},this.uppy.getState().files);Object.keys(e).forEach((function(t){if(e[t].tus&&e[t].tus.uploadUrl){var n=(0,o.Z)({},e[t].tus);delete n.uploadUrl,e[t]=(0,o.Z)((0,o.Z)({},e[t]),{},{tus:n})}})),this.uppy.setState({files:e})}},{key:"resetUploaderReferences",value:function(e,t){if(void 0===t&&(t={}),this.uploaders[e]){var n=this.uploaders[e];n.abort(),t.abort&&n.abort(!0),this.uploaders[e]=null}this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}},{key:"upload",value:function(e){var t=this,n=this;return this.resetUploaderReferences(e.id),new Promise((function(r,i){var s,a,u;t.uppy.emit("upload-started",e);var l=(0,o.Z)((0,o.Z)({},t.opts),e.tus||{});"function"===typeof l.headers&&(l.headers=l.headers(e));var c=(0,o.Z)((0,o.Z)({},jt),l);c.fingerprint=xt(e),c.onBeforeRequest=function(n){var r;if(n.getUnderlyingObject().withCredentials=!!l.withCredentials,"function"===typeof l.onBeforeRequest&&(r=l.onBeforeRequest(n,e)),(0,y.Z)(s,"shouldBeRequeued")){if(!s.shouldBeRequeued)return Promise.reject();var i,o=new Promise((function(e){i=e}));return s=t.requests.run((function(){return e.isPaused&&s.abort(),i(),function(){}})),Promise.all([o,r])}return r},c.onError=function(n){var r;t.uppy.log(n);var o=n.originalRequest?n.originalRequest.getUnderlyingObject():null;Et(o)&&(n=new St.Z(n,o)),t.resetUploaderReferences(e.id),null==(r=s)||r.abort(),t.uppy.emit("upload-error",e,n),i(n)},c.onProgress=function(n,r){t.onReceiveUploadUrl(e,u.url),t.uppy.emit("upload-progress",e,{uploader:t,bytesUploaded:n,bytesTotal:r})},c.onSuccess=function(){var n={uploadURL:u.url};t.resetUploaderReferences(e.id),s.done(),t.uppy.emit("upload-success",e,n),u.url&&t.uppy.log("Download ".concat(u.file.name," from ").concat(u.url)),r(u)};var p=function(e){var n,r=null==e||null==(n=e.originalResponse)?void 0:n.getStatus();if(429===r){if(!t.requests.isPaused){var i,o=null==(i=At(t,Tt)[Tt])?void 0:i.next();if(null==o||o.done)return!1;t.requests.rateLimit(o.value)}}else{if(r>400&&r<500&&409!==r)return!1;"undefined"!==typeof navigator&&!1===navigator.onLine&&(t.requests.isPaused||(t.requests.pause(),window.addEventListener("online",(function(){t.requests.resume()}),{once:!0})))}return s.abort(),s={shouldBeRequeued:!0,abort:function(){this.shouldBeRequeued=!1},done:function(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn:function(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};null!=l.onShouldRetry?c.onShouldRetry=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.onShouldRetry.apply(l,t.concat([p]))}:c.onShouldRetry=p;var f=function(e,t,n){(0,y.Z)(e,t)&&!(0,y.Z)(e,n)&&(e[n]=e[t])},h={};(Array.isArray(l.allowedMetaFields)?l.allowedMetaFields:Object.keys(e.meta)).forEach((function(t){h[t]=e.meta[t]})),f(h,"type","filetype"),f(h,"name","filename"),c.metadata=h,u=new dt(e.data,c),t.uploaders[e.id]=u,t.uploaderEvents[e.id]=new Pt(t.uppy),a=function(){return e.isPaused||u.start(),function(){}},u.findPreviousUploads().then((function(n){var r=n[0];r&&(t.uppy.log("[Tus] Resuming upload of ".concat(e.id," started at ").concat(r.creationTime)),u.resumeFromPreviousUpload(r))})),s=t.requests.run(a),t.onFileRemove(e.id,(function(n){s.abort(),t.resetUploaderReferences(e.id,{abort:!!u.url}),r("upload ".concat(n," was removed"))})),t.onPause(e.id,(function(e){s.abort(),e?u.abort():s=t.requests.run(a)})),t.onPauseAll(e.id,(function(){s.abort(),u.abort()})),t.onCancelAll(e.id,(function(t){"user"===(void 0===t?{}:t).reason&&(s.abort(),n.resetUploaderReferences(e.id,{abort:!!u.url})),r("upload ".concat(e.id," was canceled"))})),t.onResumeAll(e.id,(function(){s.abort(),e.error&&u.abort(),s=t.requests.run(a)}))})).catch((function(n){throw t.uppy.emit("upload-error",e,n),n}))}},{key:"uploadRemote",value:function(){var e=(0,c.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resetUploaderReferences(t.id),t.progress.uploadStarted&&t.isRestored||this.uppy.emit("upload-started",t),e.prev=2,!t.serverToken){e.next=5;break}return e.abrupt("return",this.connectToServerSocket(t));case 5:return e.next=7,At(this,Ct)[Ct](t);case 7:if(n=e.sent,this.uppy.getState().files[t.id]){e.next=10;break}return e.abrupt("return",void 0);case 10:return this.uppy.setFileState(t.id,{serverToken:n}),e.abrupt("return",this.connectToServerSocket(this.uppy.getFile(t.id)));case 14:throw e.prev=14,e.t0=e.catch(2),this.uppy.emit("upload-error",t,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"connectToServerSocket",value:function(e){var t=this,n=this;return new Promise((function(r,i){var o,s=e.serverToken,a=function(e){var t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1],n=/^http:\/\//i.test(e)?"ws":"wss";return"".concat(n,"://").concat(t)}(e.remote.companionUrl),u=new gt.sk({target:"".concat(a,"/api/").concat(s)});t.uploaderSockets[e.id]=u,t.uploaderEvents[e.id]=new Pt(t.uppy),t.onFileRemove(e.id,(function(){o.abort(),u.send("cancel",{}),t.resetUploaderReferences(e.id),r("upload ".concat(e.id," was removed"))})),t.onPause(e.id,(function(e){e?(o.abort(),u.send("pause",{})):(o.abort(),o=t.requests.run((function(){return u.send("resume",{}),function(){}})))})),t.onPauseAll(e.id,(function(){o.abort(),u.send("pause",{})})),t.onCancelAll(e.id,(function(t){"user"===(void 0===t?{}:t).reason&&(o.abort(),u.send("cancel",{}),n.resetUploaderReferences(e.id)),r("upload ".concat(e.id," was canceled"))})),t.onResumeAll(e.id,(function(){o.abort(),e.error&&u.send("pause",{}),o=t.requests.run((function(){return u.send("resume",{}),function(){}}))})),t.onRetry(e.id,(function(){u.isOpen&&(u.send("pause",{}),u.send("resume",{}))})),t.onRetryAll(e.id,(function(){u.isOpen&&(u.send("pause",{}),u.send("resume",{}))})),u.on("progress",(function(n){return bt(t,n,e)})),u.on("error",(function(n){var r=n.error.message,s=Object.assign(new Error(r),{cause:n.error});t.opts.useFastRemoteRetry?u.close():(t.resetUploaderReferences(e.id),t.uppy.setFileState(e.id,{serverToken:null})),t.uppy.emit("upload-error",e,s),o.done(),i(s)})),u.on("success",(function(n){var i={uploadURL:n.url};t.uppy.emit("upload-success",e,i),t.resetUploaderReferences(e.id),o.done(),r()})),o=t.requests.run((function(){return e.isPaused&&u.send("pause",{}),function(){}}))}))}},{key:"onReceiveUploadUrl",value:function(e,t){var n=this.uppy.getFile(e.id);n&&(n.tus&&n.tus.uploadUrl===t||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:(0,o.Z)((0,o.Z)({},n.tus),{},{uploadUrl:t})})))}},{key:"onFileRemove",value:function(e,t){this.uploaderEvents[e].on("file-removed",(function(n){e===n.id&&t(n.id)}))}},{key:"onPause",value:function(e,t){this.uploaderEvents[e].on("upload-pause",(function(n,r){e===n&&t(r)}))}},{key:"onRetry",value:function(e,t){this.uploaderEvents[e].on("upload-retry",(function(n){e===n&&t()}))}},{key:"onRetryAll",value:function(e,t){var n=this;this.uploaderEvents[e].on("retry-all",(function(){n.uppy.getFile(e)&&t()}))}},{key:"onPauseAll",value:function(e,t){var n=this;this.uploaderEvents[e].on("pause-all",(function(){n.uppy.getFile(e)&&t()}))}},{key:"onCancelAll",value:function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",(function(){n.uppy.getFile(e)&&t.apply(void 0,arguments)}))}},{key:"onResumeAll",value:function(e,t){var n=this;this.uploaderEvents[e].on("resume-all",(function(){n.uppy.getFile(e)&&t()}))}},{key:"uploadFiles",value:function(e){var t=this,n=e.map((function(n,r){var i=r+1,o=e.length;return"error"in n&&n.error?Promise.reject(new Error(n.error)):n.isRemote?(n.progress.uploadStarted&&n.isRestored||t.uppy.emit("upload-started",n),t.uploadRemote(n,i,o)):(n.progress.uploadStarted&&n.isRestored||t.uppy.emit("upload-started",n),t.upload(n,i,o))}));return function(e){var t=[],n=[];function r(e){t.push(e)}function i(e){n.push(e)}return Promise.all(e.map((function(e){return e.then(r,i)}))).then((function(){return{successful:t,failed:n}}))}(n)}},{key:"handleUpload",value:function(e){var t=this;if(0===e.length)return this.uppy.log("[Tus] No files to upload"),Promise.resolve();0===this.opts.limit&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");var n=e.map((function(e){return t.uppy.getFile(e)}));return this.uploadFiles(n).then((function(){return null}))}},{key:"install",value:function(){this.uppy.setState({capabilities:(0,o.Z)((0,o.Z)({},this.uppy.getState().capabilities),{},{resumableUploads:!0})}),this.uppy.addUploader(this.handleUpload),this.uppy.on("reset-progress",this.handleResetProgress)}},{key:"uninstall",value:function(){this.uppy.setState({capabilities:(0,o.Z)((0,o.Z)({},this.uppy.getState().capabilities),{},{resumableUploads:!1})}),this.uppy.removeUploader(this.handleUpload)}}]),n}(z.Z);Nt.VERSION="3.0.5";var Lt=n(79773),It=n(11752),qt=n(61120),Bt=n(98737),Dt=Object.create(null);Dt.open="0",Dt.close="1",Dt.ping="2",Dt.pong="3",Dt.message="4",Dt.upgrade="5",Dt.noop="6";var Mt=Object.create(null);Object.keys(Dt).forEach((function(e){Mt[Dt[e]]=e}));for(var zt={type:"error",data:"parser error"},Ht="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Wt="function"===typeof ArrayBuffer,Vt=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)},Kt=function(e,t,n){var r,i=e.type,o=e.data;return Ht&&o instanceof Blob?t?n(o):Vt(o,n):Wt&&(o instanceof ArrayBuffer||(r=o,"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?t?n(o):Vt(new Blob([o]),n):n(Dt[i]+(o||""))},Yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$t="undefined"===typeof Uint8Array?[]:new Uint8Array(256),Gt=0;Gt<Yt.length;Gt++)$t[Yt.charCodeAt(Gt)]=Gt;var Jt="function"===typeof ArrayBuffer,Xt=function(e,t){if(Jt){var n=function(e){var t,n,r,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),c=new Uint8Array(l);for(t=0;t<a;t+=4)n=$t[e.charCodeAt(t)],r=$t[e.charCodeAt(t+1)],i=$t[e.charCodeAt(t+2)],o=$t[e.charCodeAt(t+3)],c[u++]=n<<2|r>>4,c[u++]=(15&r)<<4|i>>2,c[u++]=(3&i)<<6|63&o;return l}(e);return Qt(n,t)}return{base64:!0,data:e}},Qt=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},en=function(e,t){if("string"!==typeof e)return{type:"message",data:Qt(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:Xt(e.substring(1),t)}:Mt[n]?e.length>1?{type:Mt[n],data:e.substring(1)}:{type:Mt[n]}:zt},tn=String.fromCharCode(30);function nn(e){if(e)return function(e){for(var t in nn.prototype)e[t]=nn.prototype[t];return e}(e)}nn.prototype.on=nn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},nn.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},nn.prototype.off=nn.prototype.removeListener=nn.prototype.removeAllListeners=nn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},nn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},nn.prototype.emitReserved=nn.prototype.emit,nn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},nn.prototype.hasListeners=function(e){return!!this.listeners(e).length};var rn="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function on(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})}var sn=setTimeout,an=clearTimeout;function un(e,t){t.useNativeTimers?(e.setTimeoutFn=sn.bind(rn),e.clearTimeoutFn=an.bind(rn)):(e.setTimeoutFn=setTimeout.bind(rn),e.clearTimeoutFn=clearTimeout.bind(rn))}var ln,cn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r,i){var o;return(0,p.Z)(this,n),(o=t.call(this,e)).description=r,o.context=i,o.type="TransportError",o}return(0,f.Z)(n)}((0,Bt.Z)(Error)),pn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).writable=!1,un((0,h.Z)(r),e),r.opts=e,r.query=e.query,r.readyState="",r.socket=e.socket,r}return(0,f.Z)(n,[{key:"onError",value:function(e,t,r){return(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"error",new cn(e,t,r)),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=en(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"close",e)}}]),n}(nn),fn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),hn={},dn=0,vn=0;function yn(e){var t="";do{t=fn[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function mn(){var e=yn(+new Date);return e!==ln?(dn=0,ln=e):e+"."+yn(dn++)}for(;vn<64;vn++)hn[fn[vn]]=vn;function gn(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function bn(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}var _n=!1;try{_n="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(uo){}var wn=_n;function kn(e){var t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||wn))return new XMLHttpRequest}catch(ao){}if(!t)try{return new(rn[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(ao){}}function Zn(){}var On=null!=new kn({xdomain:!1}).responseType,Pn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).polling=!1,"undefined"!==typeof location){var i="https:"===location.protocol,o=location.port;o||(o=i?"443":"80"),r.xd="undefined"!==typeof location&&e.hostname!==location.hostname||o!==e.port,r.xs=e.secure!==i}var s=e&&e.forceBase64;return r.supportsBinary=On&&!s,r}return(0,f.Z)(n,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",(function(){--r||n()}))),this.writable||(r++,this.once("drain",(function(){--r||n()})))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split(tn),r=[],i=0;i<n.length;i++){var o=en(n[i],t);if(r.push(o),"error"===o.type)break}return r})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var n=e.length,r=new Array(n),i=0;e.forEach((function(e,o){Kt(e,!1,(function(e){r[o]=e,++i===n&&t(r.join(tn))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emitReserved("drain")}))}))}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=mn()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var r=gn(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new Sn(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(function(e,t){n.onError("xhr post error",e,t)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,n){e.onError("xhr poll error",t,n)})),this.pollXhr=t}}]),n}(pn),Sn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){var i;return(0,p.Z)(this,n),i=t.call(this),un((0,h.Z)(i),r),i.opts=r,i.method=r.method||"GET",i.uri=e,i.async=!1!==r.async,i.data=void 0!==r.data?r.data:null,i.create(),i}return(0,f.Z)(n,[{key:"create",value:function(){var e=this,t=on(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var r=this.xhr=new kn(t);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var i in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}catch(ao){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(ao){}try{r.setRequestHeader("Accept","*/*")}catch(ao){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?e.onLoad():e.setTimeoutFn((function(){e.onError("number"===typeof r.status?r.status:0)}),0))},r.send(this.data)}catch(ao){return void this.setTimeoutFn((function(){e.onError(ao)}),0)}"undefined"!==typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=Zn,e)try{this.xhr.abort()}catch(ao){}"undefined"!==typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),n}(nn);if(Sn.requestsCount=0,Sn.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",En);else if("function"===typeof addEventListener){addEventListener("onpagehide"in rn?"pagehide":"unload",En,!1)}function En(){for(var e in Sn.requests)Sn.requests.hasOwnProperty(e)&&Sn.requests[e].abort()}var xn="function"===typeof Promise&&"function"===typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},An=rn.WebSocket||rn.MozWebSocket,Rn="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),Un=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsBinary=!e.forceBase64,r}return(0,f.Z)(n,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=Rn?{}:on(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Rn?new An(e,t,n):t?new An(e,t):new An(e)}catch(uo){return this.emitReserved("error",uo)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(n){var r=e[n],i=n===e.length-1;Kt(r,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(ao){}i&&xn((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},r=0;r<e.length;r++)n(r)}},{key:"doClose",value:function(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=mn()),this.supportsBinary||(e.b64=1);var r=gn(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"check",value:function(){return!!An}}]),n}(pn),jn={websocket:Un,polling:Pn},Tn=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Cn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Fn(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=Tn.exec(e||""),o={},s=14;s--;)o[Cn[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}var Nn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,p.Z)(this,n),r=t.call(this),e&&"object"===typeof e&&(i=e,e=null),e?(e=Fn(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=Fn(i.host).host),un((0,h.Z)(r),i),r.secure=null!=i.secure?i.secure:"undefined"!==typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=r.secure?"443":"80"),r.hostname=i.hostname||("undefined"!==typeof location?location.hostname:"localhost"),r.port=i.port||("undefined"!==typeof location&&location.port?location.port:r.secure?"443":"80"),r.transports=i.transports||["polling","websocket"],r.readyState="",r.writeBuffer=[],r.prevBufferLen=0,r.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),r.opts.path=r.opts.path.replace(/\/$/,"")+"/","string"===typeof r.opts.query&&(r.opts.query=bn(r.opts.query)),r.id=null,r.upgrades=null,r.pingInterval=null,r.pingTimeout=null,r.pingTimeoutTimer=null,"function"===typeof addEventListener&&(r.opts.closeOnBeforeunload&&(r.beforeunloadEventListener=function(){r.transport&&(r.transport.removeAllListeners(),r.transport.close())},addEventListener("beforeunload",r.beforeunloadEventListener,!1)),"localhost"!==r.hostname&&(r.offlineEventListener=function(){r.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",r.offlineEventListener,!1))),r.open(),r}return(0,f.Z)(n,[{key:"createTransport",value:function(e){var t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new jn[e](n)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(ao){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(e){return t.onClose("transport close",e)}))}},{key:"probe",value:function(e){var t=this,r=this.createTransport(e),i=!1;n.priorWebsocketSuccess=!1;var o=function(){i||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!i)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess="websocket"===r.name,t.transport.pause((function(){i||"closed"!==t.readyState&&(p(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emitReserved("upgrade",r),r=null,t.upgrading=!1,t.flush())}))}else{var o=new Error("probe error");o.transport=r.name,t.emitReserved("upgradeError",o)}})))};function s(){i||(i=!0,p(),r.close(),r=null)}var a=function(e){var n=new Error("probe error: "+e);n.transport=r.name,s(),t.emitReserved("upgradeError",n)};function u(){a("transport closed")}function l(){a("socket closed")}function c(e){r&&e.name!==r.name&&s()}var p=function(){r.removeListener("open",o),r.removeListener("error",a),r.removeListener("close",u),t.off("close",l),t.off("upgrading",c)};r.once("open",o),r.once("error",a),r.once("close",u),this.once("close",l),this.once("upgrading",c),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(t+="string"===typeof(e=r)?function(e){for(var t=0,n=0,r=0,i=e.length;r<i;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},n=function n(){e.off("upgrade",n),e.off("upgradeError",n),t()},r=function(){e.once("upgrade",n),e.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?r():t()})):this.upgrading?r():t()),this}},{key:"onError",value:function(e){n.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}]),n}(nn);Nn.protocol=4;Nn.protocol;var Ln="function"===typeof ArrayBuffer,In=Object.prototype.toString,qn="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===In.call(Blob),Bn="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===In.call(File);function Dn(e){return Ln&&(e instanceof ArrayBuffer||function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||qn&&e instanceof Blob||Bn&&e instanceof File}function Mn(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(Mn(e[n]))return!0;return!1}if(Dn(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Mn(e.toJSON(),!0);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&Mn(e[i]))return!0;return!1}function zn(e){var t=[],n=e.data,r=e;return r.data=Hn(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Hn(e,t){if(!e)return e;if(Dn(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=Hn(e[i],t);return r}if("object"===typeof e&&!(e instanceof Date)){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(o[s]=Hn(e[s],t));return o}return e}function Wn(e,t){return e.data=Vn(e.data,t),e.attachments=void 0,e}function Vn(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=Vn(e[n],t);else if("object"===typeof e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Vn(e[r],t));return e}var Kn,Yn=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Kn||(Kn={}));var $n=function(){function e(t){(0,p.Z)(this,e),this.replacer=t}return(0,f.Z)(e,[{key:"encode",value:function(e){return e.type!==Kn.EVENT&&e.type!==Kn.ACK||!Mn(e)?[this.encodeAsString(e)]:(e.type=e.type===Kn.EVENT?Kn.BINARY_EVENT:Kn.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==Kn.BINARY_EVENT&&e.type!==Kn.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=zn(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),e}(),Gn=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).reviver=e,r}return(0,f.Z)(n,[{key:"add",value:function(e){var t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");(t=this.decodeString(e)).type===Kn.BINARY_EVENT||t.type===Kn.BINARY_ACK?(this.reconstructor=new Jn(t),0===t.attachments&&(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t)):(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t)}else{if(!Dn(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,(0,It.Z)((0,qt.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===Kn[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Kn.BINARY_EVENT||r.type===Kn.BINARY_ACK){for(var i=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var o=e.substring(i,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===e.charAt(t+1)){for(var s=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(s,t)}else r.nsp="/";var a=e.charAt(t+1);if(""!==a&&Number(a)==a){for(var u=t+1;++t;){var l=e.charAt(t);if(null==l||Number(l)!=l){--t;break}if(t===e.length)break}r.id=Number(e.substring(u,t+1))}if(e.charAt(++t)){var c=this.tryParse(e.substr(t));if(!n.isPayloadValid(r.type,c))throw new Error("invalid payload");r.data=c}return r}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(ao){return!1}}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case Kn.CONNECT:return"object"===typeof t;case Kn.DISCONNECT:return void 0===t;case Kn.CONNECT_ERROR:return"string"===typeof t||"object"===typeof t;case Kn.EVENT:case Kn.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Kn.ACK:case Kn.BINARY_ACK:return Array.isArray(t)}}}]),n}(nn),Jn=function(){function e(t){(0,p.Z)(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return(0,f.Z)(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Wn(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}();function Xn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var Qn=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),er=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r,i){var o;return(0,p.Z)(this,n),(o=t.call(this)).connected=!1,o.receiveBuffer=[],o.sendBuffer=[],o.ids=0,o.acks={},o.flags={},o.io=e,o.nsp=r,i&&i.auth&&(o.auth=i.auth),o.io._autoConnect&&o.open(),o}return(0,f.Z)(n,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[Xn(e,"open",this.onopen.bind(this)),Xn(e,"packet",this.onpacket.bind(this)),Xn(e,"error",this.onerror.bind(this)),Xn(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(Qn.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.unshift(e);var i={type:Kn.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof n[n.length-1]){var o=this.ids++,s=n.pop();this._registerAckCallback(o,s),i.id=o}var a=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,u=this.flags.volatile&&(!a||!this.connected);return u||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var n=this,r=this.flags.timeout;if(void 0!==r){var i=this.io.setTimeoutFn((function(){delete n.acks[e];for(var r=0;r<n.sendBuffer.length;r++)n.sendBuffer[r].id===e&&n.sendBuffer.splice(r,1);t.call(n,new Error("operation has timed out"))}),r);this.acks[e]=function(){n.io.clearTimeoutFn(i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];t.apply(n,[null].concat(r))}}else this.acks[e]=t}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e.packet({type:Kn.CONNECT,data:t})})):this.packet({type:Kn.CONNECT,data:this.auth})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case Kn.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Kn.EVENT:case Kn.BINARY_EVENT:this.onevent(e);break;case Kn.ACK:case Kn.BINARY_ACK:this.onack(e);break;case Kn.DISCONNECT:this.ondisconnect();break;case Kn.CONNECT_ERROR:this.destroy();var n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,r=this._anyListeners.slice(),i=(0,s.Z)(r);try{for(i.s();!(t=i.n()).done;){t.value.apply(this,e)}}catch(uo){i.e(uo)}finally{i.f()}}(0,It.Z)((0,qt.Z)(n.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];t.packet({type:Kn.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:Kn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=this._anyOutgoingListeners.slice(),r=(0,s.Z)(n);try{for(r.s();!(t=r.n()).done;){t.value.apply(this,e.data)}}catch(uo){r.e(uo)}finally{r.f()}}}}]),n}(nn);function tr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}tr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},tr.prototype.reset=function(){this.attempts=0},tr.prototype.setMin=function(e){this.ms=e},tr.prototype.setMax=function(e){this.max=e},tr.prototype.setJitter=function(e){this.jitter=e};var nr=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,i){var o,s;(0,p.Z)(this,n),(o=t.call(this)).nsps={},o.subs=[],e&&"object"===typeof e&&(i=e,e=void 0),(i=i||{}).path=i.path||"/socket.io",o.opts=i,un((0,h.Z)(o),i),o.reconnection(!1!==i.reconnection),o.reconnectionAttempts(i.reconnectionAttempts||1/0),o.reconnectionDelay(i.reconnectionDelay||1e3),o.reconnectionDelayMax(i.reconnectionDelayMax||5e3),o.randomizationFactor(null!==(s=i.randomizationFactor)&&void 0!==s?s:.5),o.backoff=new tr({min:o.reconnectionDelay(),max:o.reconnectionDelayMax(),jitter:o.randomizationFactor()}),o.timeout(null==i.timeout?2e4:i.timeout),o._readyState="closed",o.uri=e;var a=i.parser||r;return o.encoder=new a.Encoder,o.decoder=new a.Decoder,o._autoConnect=!1!==i.autoConnect,o._autoConnect&&o.open(),o}return(0,f.Z)(n,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new Nn(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var i=Xn(n,"open",(function(){r.onopen(),e&&e()})),o=Xn(n,"error",(function(n){r.cleanup(),r._readyState="closed",t.emitReserved("error",n),e?e(n):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;0===s&&i();var a=this.setTimeoutFn((function(){i(),n.close(),n.emit("error",new Error("timeout"))}),s);this.opts.autoUnref&&a.unref(),this.subs.push((function(){clearTimeout(a)}))}return this.subs.push(i),this.subs.push(o),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(Xn(e,"ping",this.onping.bind(this)),Xn(e,"data",this.ondata.bind(this)),Xn(e,"error",this.onerror.bind(this)),Xn(e,"close",this.onclose.bind(this)),Xn(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(ao){this.onclose("parse error",ao)}}},{key:"ondecoded",value:function(e){var t=this;xn((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n||(n=new er(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",n)):t.onreconnect()})))}),n);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),n}(nn),rr={};function ir(e,t){"object"===typeof e&&(t=e,e=void 0);var n,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=Fn(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),i=r.source,o=r.id,s=r.path,a=rr[o]&&s in rr[o].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?n=new nr(i,t):(rr[o]||(rr[o]=new nr(i,t)),n=rr[o]),r.query&&!t.query&&(t.query=r.queryKey),n.socket(r.path,t)}Object.assign(ir,{Manager:nr,Socket:er,io:ir,connect:ir});var or=n(73411);function sr(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var ar=0;function ur(e){return"__private_"+ar+++"_"+e}var lr="ASSEMBLY_EXECUTING",cr="ASSEMBLY_COMPLETED",pr=["ASSEMBLY_UPLOADING",lr,cr];function fr(e,t){return pr.indexOf(e)>=pr.indexOf(t)}var hr=ur("rateLimitedQueue"),dr=ur("fetchWithNetworkError"),vr=ur("previousFetchStatusStillPending"),yr=ur("onFinished"),mr=ur("connectSocket"),gr=ur("onError"),br=ur("beginPolling"),_r=ur("fetchStatus"),wr=ur("diffStatus");function kr(){this.emit("finished"),this.close()}function Zr(){var e=this,t=function(e){var t=/^\w+:\/\//.exec(e),n=0;t&&(n=t[0].length+1);var r=e.indexOf("/",n);return-1===r?{origin:e,pathname:"/"}:{origin:e.slice(0,r),pathname:e.slice(r)}}(this.status.websocket_url),n=ir(t.origin,{transports:["websocket"],path:t.pathname});n.on("connect",(function(){n.emit("assembly_connect",{id:e.status.assembly_id}),e.emit("connect")})),n.on("connect_error",(function(){n.disconnect(),e.socket=null})),n.on("assembly_finished",(function(){sr(e,yr)[yr]()})),n.on("assembly_upload_finished",(function(t){e.emit("upload",t),e.status.uploads.push(t)})),n.on("assembly_uploading_finished",(function(){e.emit("executing")})),n.on("assembly_upload_meta_data_extracted",(function(){e.emit("metadata"),sr(e,_r)[_r]({diff:!1})})),n.on("assembly_result_finished",(function(t,n){e.emit("result",t,n),e.status.results[t]||(e.status.results[t]=[]),e.status.results[t].push(n)})),n.on("assembly_error",(function(t){sr(e,gr)[gr](t),sr(e,_r)[_r]({diff:!1})})),this.socket=n}function Or(e){this.emit("error",Object.assign(new Error(e.message),e)),this.close()}function Pr(){var e=this;this.pollInterval=setInterval((function(){e.socket&&e.socket.connected||sr(e,_r)[_r]()}),2e3)}function Sr(e){return Er.apply(this,arguments)}function Er(){return(Er=(0,c.Z)((0,l.Z)().mark((function e(t){var n,r,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(void 0===t?{}:t).diff,r=void 0===n||n,!(this.closed||sr(this,hr)[hr].isPaused||sr(this,vr)[vr])){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,sr(this,vr)[vr]=!0,e.next=7,sr(this,dr)[dr](this.status.assembly_ssl_url);case 7:if(i=e.sent,sr(this,vr)[vr]=!1,!this.closed){e.next=11;break}return e.abrupt("return");case 11:if(429!==i.status){e.next=14;break}return sr(this,hr)[hr].rateLimit(2e3),e.abrupt("return");case 14:if(i.ok){e.next=17;break}return sr(this,gr)[gr](new St.Z(i.statusText)),e.abrupt("return");case 17:return e.next=19,i.json();case 19:if(o=e.sent,!this.closed){e.next=22;break}return e.abrupt("return");case 22:this.emit("status",o),r?this.updateStatus(o):this.status=o,e.next=29;break;case 26:e.prev=26,e.t0=e.catch(3),sr(this,gr)[gr](e.t0);case 29:case"end":return e.stop()}}),e,this,[[3,26]])})))).apply(this,arguments)}function xr(e,t){var n=this,r=e.ok,i=t.ok;if(t.error&&!e.error)return sr(this,gr)[gr](t);var o=fr(i,lr)&&!fr(r,lr);o&&this.emit("executing"),Object.keys(t.uploads).filter((function(t){return!(0,y.Z)(e.uploads,t)})).forEach((function(e){n.emit("upload",t.uploads[e])})),o&&this.emit("metadata"),Object.keys(t.results).forEach((function(r){var i=t.results[r],o=e.results[r];i.filter((function(e){return!o||!o.some((function(t){return t.id===e.id}))})).forEach((function(e){n.emit("result",r,e)}))})),fr(i,cr)&&!fr(r,cr)&&this.emit("finished")}var Ar=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){var i;return(0,p.Z)(this,n),i=t.call(this),Object.defineProperty((0,h.Z)(i),wr,{value:xr}),Object.defineProperty((0,h.Z)(i),_r,{value:Sr}),Object.defineProperty((0,h.Z)(i),br,{value:Pr}),Object.defineProperty((0,h.Z)(i),gr,{value:Or}),Object.defineProperty((0,h.Z)(i),mr,{value:Zr}),Object.defineProperty((0,h.Z)(i),yr,{value:kr}),Object.defineProperty((0,h.Z)(i),hr,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),dr,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),vr,{writable:!0,value:!1}),i.status=e,i.socket=null,i.pollInterval=null,i.closed=!1,sr((0,h.Z)(i),hr)[hr]=r,sr((0,h.Z)(i),dr)[dr]=r.wrapPromiseFunction(or.Z),i}return(0,f.Z)(n,[{key:"connect",value:function(){sr(this,mr)[mr](),sr(this,br)[br]()}},{key:"update",value:function(){return sr(this,_r)[_r]({diff:!0})}},{key:"updateStatus",value:function(e){sr(this,wr)[wr](this.status,e),this.status=e}},{key:"close",value:function(){this.closed=!0,this.socket&&(this.socket.disconnect(),this.socket=null),clearInterval(this.pollInterval),this.pollInterval=null}}]),n}(Lt);function Rr(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Ur=0;function jr(e){return"__private_"+Ur+++"_"+e}var Tr="/assemblies",Cr=jr("headers"),Fr=jr("fetchWithNetworkError"),Nr=jr("fetchJSON"),Lr=jr("reportError"),Ir=function(){function e(t){var n=this;(0,p.Z)(this,e),void 0===t&&(t={}),Object.defineProperty(this,Nr,{value:qr}),Object.defineProperty(this,Cr,{writable:!0,value:{}}),Object.defineProperty(this,Fr,{writable:!0,value:void 0}),Object.defineProperty(this,Lr,{writable:!0,value:function(e,t){if(!1===n.opts.errorReporting)throw e;var r={type:t.type};throw t.assembly&&(r.assembly=t.assembly.assembly_id,r.instance=t.assembly.instance),t.url&&(r.endpoint=t.url),n.submitError(e,r).catch((function(){})),e}}),this.opts=t,null!=this.opts.client&&(Rr(this,Cr)[Cr]["Transloadit-Client"]=this.opts.client),Rr(this,Fr)[Fr]=this.opts.rateLimitedQueue.wrapPromiseFunction(or.Z)}return(0,f.Z)(e,[{key:"createAssembly",value:function(e){var t=this,n=e.params,r=e.fields,i=e.signature,o=e.expectedFiles,s=new FormData;s.append("params","string"===typeof n?n:JSON.stringify(n)),i&&s.append("signature",i),Object.keys(r).forEach((function(e){s.append(e,r[e])})),s.append("num_expected_upload_files",o);var a=new URL(Tr,"".concat(this.opts.service)).href;return Rr(this,Nr)[Nr](a,{method:"post",headers:Rr(this,Cr)[Cr],body:s}).catch((function(e){return Rr(t,Lr)[Lr](e,{url:a,type:"API_ERROR"})}))}},{key:"reserveFile",value:function(e,t){var n=this,r=encodeURIComponent(t.size),i="".concat(e.assembly_ssl_url,"/reserve_file?size=").concat(r);return Rr(this,Nr)[Nr](i,{method:"post",headers:Rr(this,Cr)[Cr]}).catch((function(r){return Rr(n,Lr)[Lr](r,{assembly:e,file:t,url:i,type:"API_ERROR"})}))}},{key:"addFile",value:function(e,t){var n=this;if(!t.uploadURL)return Promise.reject(new Error("File does not have an `uploadURL`."));var r=encodeURIComponent(t.size),i=encodeURIComponent(t.uploadURL),o=encodeURIComponent(t.name),s="size=".concat(r,"&filename=").concat(o,"&fieldname=").concat("file","&s3Url=").concat(i),a="".concat(e.assembly_ssl_url,"/add_file?").concat(s);return Rr(this,Nr)[Nr](a,{method:"post",headers:Rr(this,Cr)[Cr]}).catch((function(r){return Rr(n,Lr)[Lr](r,{assembly:e,file:t,url:a,type:"API_ERROR"})}))}},{key:"updateNumberOfFilesInAssembly",value:function(e,t){var n=this,r=new URL(e.assembly_ssl_url);r.pathname="/update_assemblies";var i=JSON.stringify({assembly_updates:[{assembly_id:e.assembly_id,num_expected_upload_files:t}]});return Rr(this,Nr)[Nr](r,{method:"post",headers:Rr(this,Cr)[Cr],body:i}).catch((function(e){return Rr(n,Lr)[Lr](e,{url:r,type:"API_ERROR"})}))}},{key:"cancelAssembly",value:function(e){var t=this,n=e.assembly_ssl_url;return Rr(this,Nr)[Nr](n,{method:"delete",headers:Rr(this,Cr)[Cr]}).catch((function(e){return Rr(t,Lr)[Lr](e,{url:n,type:"API_ERROR"})}))}},{key:"getAssemblyStatus",value:function(e){var t=this;return Rr(this,Nr)[Nr](e,{headers:Rr(this,Cr)[Cr]}).catch((function(n){return Rr(t,Lr)[Lr](n,{url:e,type:"STATUS_ERROR"})}))}},{key:"submitError",value:function(e,t){var n=void 0===t?{}:t,r=n.endpoint,i=n.instance,o=n.assembly,s=e.details?"".concat(e.message," (").concat(e.details,")"):e.message;return Rr(this,Nr)[Nr]("https://transloaditstatus.com/client_error",{method:"post",body:JSON.stringify({endpoint:r,instance:i,assembly_id:o,agent:"undefined"!==typeof navigator?navigator.userAgent:"",client:this.opts.client,error:s})})}}]),e}();function qr(){for(var e,t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=Rr(this,Fr))[Fr].apply(e,r).then((function(e){var n;if(429===e.status)return t.opts.rateLimitedQueue.rateLimit(2e3),(n=Rr(t,Nr))[Nr].apply(n,r);if(!e.ok){var i=new Error(e.statusText);return i.statusCode=e.status,"".concat(r[0]).endsWith(Tr)?e.json().then((function(e){if(!e.error)throw i;var t=new Error(e.error);throw t.details=e.message,t.assembly=e,e.assembly_id&&(t.details+=" Assembly ID: ".concat(e.assembly_id)),t}),(function(e){throw e.cause=i,e})):Promise.reject(i)}return e.json()}))}function Br(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Dr=0;function Mr(e){return"__private_"+Dr+++"_"+e}function zr(e){if(null==e)throw new Error("Transloadit: The `params` option is required.");if("string"===typeof e)try{e=JSON.parse(e)}catch(uo){throw new m.Z("Transloadit: The `params` option is a malformed JSON string.",{cause:uo})}if(!e.auth||!e.auth.key)throw new Error("Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/c/template-credentials")}function Hr(e){var t,n=Object.create(null),r=(0,s.Z)(e.filter(Boolean));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.fileIDs,a=i.options,u=JSON.stringify(a);u in n?n[u].fileIDArrays.push(o):n[u]={options:a,fileIDArrays:[o]}}}catch(uo){r.e(uo)}finally{r.f()}return Object.values(n).map((function(e){return{options:e.options,fileIDs:e.fileIDArrays.flat(1)}}))}var Wr=Mr("getAssemblyOptions"),Vr=function(){function e(t,n){(0,p.Z)(this,e),Object.defineProperty(this,Wr,{value:Kr}),this.files=t,this.opts=n}return(0,f.Z)(e,[{key:"build",value:function(){var e=(0,c.Z)((0,l.Z)().mark((function e(){var t,n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.opts,!(this.files.length>0)){e.next=3;break}return e.abrupt("return",Promise.all(this.files.map((function(e){return Br(r,Wr)[Wr](e)}))).then(Hr));case 3:if(!t.alwaysRunAssembly){e.next=9;break}return e.next=6,t.getAssemblyOptions(null,t);case 6:return zr((n=e.sent).params),e.abrupt("return",[{fileIDs:this.files.map((function(e){return e.id})),options:n}]);case 9:return e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Kr(e){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,c.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return",void 0);case 2:return n=this.opts,e.next=5,n.getAssemblyOptions(t,n);case 5:if(r=e.sent,null!=t){e.next=8;break}return e.abrupt("return",void 0);case 8:return Array.isArray(r.fields)?r.fields=Object.fromEntries(r.fields.map((function(e){return[e,t.meta[e]]}))):null==r.fields&&(r.fields={}),zr(r.params),e.abrupt("return",{fileIDs:[t.id],options:r});case 11:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var $r=Vr;function Gr(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Jr=0;function Xr(e){return"__private_"+Jr+++"_"+e}var Qr=Xr("assemblyIDs"),ei=Xr("reject"),ti=Xr("remaining"),ni=Xr("resolve"),ri=Xr("uppy"),ii=Xr("watching"),oi=Xr("onAssemblyComplete"),si=Xr("onAssemblyCancel"),ai=Xr("onAssemblyError"),ui=Xr("onImportError"),li=Xr("checkAllComplete"),ci=Xr("removeListeners"),pi=Xr("addListeners"),fi=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){var i;return(0,p.Z)(this,n),i=t.call(this),Object.defineProperty((0,h.Z)(i),pi,{value:yi}),Object.defineProperty((0,h.Z)(i),ci,{value:vi}),Object.defineProperty((0,h.Z)(i),li,{value:di}),Object.defineProperty((0,h.Z)(i),ii,{value:hi}),Object.defineProperty((0,h.Z)(i),Qr,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),ei,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),ti,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),ni,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),ri,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),oi,{writable:!0,value:function(e){Gr((0,h.Z)(i),ii)[ii](e.assembly_id)&&(Gr((0,h.Z)(i),ri)[ri].log("[Transloadit] AssemblyWatcher: Got Assembly finish ".concat(e.assembly_id)),i.emit("assembly-complete",e.assembly_id),Gr((0,h.Z)(i),li)[li]())}}),Object.defineProperty((0,h.Z)(i),si,{writable:!0,value:function(e){Gr((0,h.Z)(i),ii)[ii](e.assembly_id)&&Gr((0,h.Z)(i),li)[li]()}}),Object.defineProperty((0,h.Z)(i),ai,{writable:!0,value:function(e,t){Gr((0,h.Z)(i),ii)[ii](e.assembly_id)&&(Gr((0,h.Z)(i),ri)[ri].log("[Transloadit] AssemblyWatcher: Got Assembly error ".concat(e.assembly_id)),Gr((0,h.Z)(i),ri)[ri].log(t),i.emit("assembly-error",e.assembly_id,t),Gr((0,h.Z)(i),li)[li]())}}),Object.defineProperty((0,h.Z)(i),ui,{writable:!0,value:function(e,t,n){Gr((0,h.Z)(i),ii)[ii](e.assembly_id)&&Gr((0,h.Z)(i),ai)[ai](e,n)}}),Gr((0,h.Z)(i),ri)[ri]=e,Gr((0,h.Z)(i),Qr)[Qr]=r,Gr((0,h.Z)(i),ti)[ti]=r.length,i.promise=new Promise((function(e,t){Gr((0,h.Z)(i),ni)[ni]=e,Gr((0,h.Z)(i),ei)[ei]=t})),Gr((0,h.Z)(i),pi)[pi](),i}return(0,f.Z)(n)}(Lt);function hi(e){return-1!==Gr(this,Qr)[Qr].indexOf(e)}function di(){Gr(this,ti)[ti]-=1,0===Gr(this,ti)[ti]&&(Gr(this,ci)[ci](),Gr(this,ni)[ni]())}function vi(){Gr(this,ri)[ri].off("transloadit:complete",Gr(this,oi)[oi]),Gr(this,ri)[ri].off("transloadit:assembly-cancel",Gr(this,si)[si]),Gr(this,ri)[ri].off("transloadit:assembly-error",Gr(this,ai)[ai]),Gr(this,ri)[ri].off("transloadit:import-error",Gr(this,ui)[ui])}function yi(){Gr(this,ri)[ri].on("transloadit:complete",Gr(this,oi)[oi]),Gr(this,ri)[ri].on("transloadit:assembly-cancel",Gr(this,si)[si]),Gr(this,ri)[ri].on("transloadit:assembly-error",Gr(this,ai)[ai]),Gr(this,ri)[ri].on("transloadit:import-error",Gr(this,ui)[ui])}var mi=fi,gi={strings:{creatingAssembly:"Preparing upload...",creatingAssemblyFailed:"Transloadit: Could not create Assembly",encoding:"Encoding..."}};function bi(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var _i=0;function wi(e){return"__private_"+_i+++"_"+e}function ki(e,t){return{params:t.params,signature:t.signature,fields:t.fields}}var Zi=function(e){return function(t){var n=new m.Z("Failed to send error to the client",{cause:t});console.error(n,e)}},Oi=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/companion/,Pi=wi("rateLimitedQueue"),Si=wi("getClientVersion"),Ei=wi("attachAssemblyMetadata"),xi=wi("createAssembly"),Ai=wi("createAssemblyWatcher"),Ri=wi("shouldWaitAfterUpload"),Ui=wi("reserveFiles"),ji=wi("onFileUploadURLAvailable"),Ti=wi("findFile"),Ci=wi("onFileUploadComplete"),Fi=wi("onResult"),Ni=wi("onAssemblyFinished"),Li=wi("cancelAssembly"),Ii=wi("onCancelAll"),qi=wi("getPersistentData"),Bi=wi("onRestored"),Di=wi("connectAssembly"),Mi=wi("prepareUpload"),zi=wi("afterUpload"),Hi=wi("closeAssemblyIfExists"),Wi=wi("onError"),Vi=wi("onTusError"),Ki=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(e,r){var i,f;(0,p.Z)(this,n),i=t.call(this,e,r),f=(0,h.Z)(i),Object.defineProperty((0,h.Z)(i),Di,{value:so}),Object.defineProperty((0,h.Z)(i),Li,{value:io}),Object.defineProperty((0,h.Z)(i),Ni,{value:ro}),Object.defineProperty((0,h.Z)(i),Fi,{value:no}),Object.defineProperty((0,h.Z)(i),Ci,{value:to}),Object.defineProperty((0,h.Z)(i),Ti,{value:eo}),Object.defineProperty((0,h.Z)(i),Ui,{value:Qi}),Object.defineProperty((0,h.Z)(i),Ri,{value:Xi}),Object.defineProperty((0,h.Z)(i),Ai,{value:Ji}),Object.defineProperty((0,h.Z)(i),xi,{value:Gi}),Object.defineProperty((0,h.Z)(i),Ei,{value:$i}),Object.defineProperty((0,h.Z)(i),Si,{value:Yi}),Object.defineProperty((0,h.Z)(i),Pi,{writable:!0,value:void 0}),Object.defineProperty((0,h.Z)(i),ji,{writable:!0,value:function(e){var t,n=i.uppy.getFile(e.id);if(null!=n&&null!=(t=n.transloadit)&&t.assembly){var r=i.getPluginState().assemblies[n.transloadit.assembly];i.client.addFile(r,n).catch((function(e){i.uppy.log(e),i.uppy.emit("transloadit:import-error",r,n.id,e)}))}}}),Object.defineProperty((0,h.Z)(i),Ii,{writable:!0,value:function(){var e=(0,c.Z)((0,l.Z)().mark((function e(t){var n,r,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(void 0===t?{}:t).reason,e.prev=1,"user"===n){e.next=4;break}return e.abrupt("return");case 4:return r=f.getPluginState(),i=r.uploadsAssemblies,o=Object.values(i).flat(1),s=o.map((function(e){return f.getAssembly(e)})),e.next=9,Promise.all(s.map((function(e){return bi(f,Li)[Li](e)})));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),f.uppy.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty((0,h.Z)(i),qi,{writable:!0,value:function(e){var t=i.getPluginState(),n=t.assemblies,r=t.uploadsAssemblies;e((0,u.Z)({},i.id,{assemblies:n,uploadsAssemblies:r}))}}),Object.defineProperty((0,h.Z)(i),Bi,{writable:!0,value:function(e){var t=e&&e[i.id]?e[i.id]:{},n=t.assemblies||{},r=t.uploadsAssemblies||{};if(0!==Object.keys(r).length){i.restored=Promise.resolve().then((function(){return function(e){for(var t={},n=[],o=function(){var e=(0,a.Z)(l[u],2),r=e[0],o=e[1];o.uploads.forEach((function(e){var n=bi((0,h.Z)(i),Ti)[Ti](e);t[e.id]={id:n.id,assembly:r,uploadedFile:e}}));var c=i.getPluginState();Object.keys(o.results).forEach((function(e){var t,i=(0,s.Z)(o.results[e]);try{for(i.s();!(t=i.n()).done;){var a=t.value,u=c.files[a.original_id];a.localId=u?u.id:null,n.push({id:a.id,result:a,stepName:e,assembly:r})}}catch(uo){i.e(uo)}finally{i.f()}}))},u=0,l=Object.entries(e);u<l.length;u++)o();i.setPluginState({assemblies:e,files:t,results:n,uploadsAssemblies:r})}(n),function(){var e=i.getPluginState(),t=e.assemblies,n=e.uploadsAssemblies;Object.keys(n).forEach((function(e){var t=n[e];bi((0,h.Z)(i),Ai)[Ai](t,e)})),Object.keys(t).forEach((function(e){var n=new Ar(t[e],bi((0,h.Z)(i),Pi)[Pi]);bi((0,h.Z)(i),Di)[Di](n)}))}(),function(){var e=i.getPluginState().assemblies;return Promise.all(Object.keys(e).map((function(e){return i.activeAssemblies[e].update()})))}()})),i.restored.then((function(){i.restored=null}))}}}),Object.defineProperty((0,h.Z)(i),Mi,{writable:!0,value:function(e,t){var n=e.map((function(e){return i.uppy.getFile(e)})),r=n.filter((function(e){return!e.error&&(i.uppy.emit("preprocess-progress",e,{mode:"indeterminate",message:i.i18n("creatingAssembly")}),!0)})),s=function(){var e=(0,c.Z)((0,l.Z)().mark((function e(n){var r,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.fileIDs,o=n.options,e.prev=1,e.next=4,bi((0,h.Z)(i),xi)[xi](r,t,o);case 4:if(s=e.sent,!i.opts.importFromUploadURLs){e.next=8;break}return e.next=8,bi((0,h.Z)(i),Ui)[Ui](s,r);case 8:return r.forEach((function(e){var t=i.uppy.getFile(e);i.uppy.emit("preprocess-complete",t)})),e.abrupt("return",s);case 12:throw e.prev=12,e.t0=e.catch(1),r.forEach((function(t){var n=i.uppy.getFile(t);i.uppy.emit("preprocess-complete",n),i.uppy.emit("upload-error",n,e.t0)})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),a=i.getPluginState().uploadsAssemblies;return i.setPluginState({uploadsAssemblies:(0,o.Z)((0,o.Z)({},a),{},(0,u.Z)({},t,[]))}),new $r(r,i.opts).build().then((function(e){return Promise.all(e.map(s))})).then((function(e){var n=e.filter(Boolean),r=n.map((function(e){return e.status.assembly_id}));return bi((0,h.Z)(i),Ai)[Ai](r,t),Promise.all(n.map((function(e){return bi((0,h.Z)(i),Di)[Di](e)})))})).catch((function(e){throw r.forEach((function(t){i.uppy.emit("preprocess-complete",t),i.uppy.emit("upload-error",t,e)})),e}))}}),Object.defineProperty((0,h.Z)(i),zi,{writable:!0,value:function(e,t){var n=e.map((function(e){return i.uppy.getFile(e)})),r=n.filter((function(e){return!e.error})).map((function(e){return e.id})),s=i.getPluginState();if(i.restored)return i.restored.then((function(){return bi((0,h.Z)(i),zi)[zi](r,t)}));var a=s.uploadsAssemblies[t],u=function(){a.forEach((function(e){i.activeAssemblies[e].close(),delete i.activeAssemblies[e]}))};if(!bi((0,h.Z)(i),Ri)[Ri]()){u();var l=a.map((function(e){return i.getAssembly(e)}));return i.uppy.addResultData(t,{transloadit:l}),Promise.resolve()}return 0===a.length?(i.uppy.addResultData(t,{transloadit:[]}),Promise.resolve()):(n.filter((function(e){return!(0,y.Z)(i.completedFiles,e.id)})).forEach((function(e){i.uppy.emit("postprocess-progress",e,{mode:"indeterminate",message:i.i18n("encoding")})})),i.assemblyWatchers[t].promise.then((function(){u();var e=a.map((function(e){return i.getAssembly(e)})),n=(0,o.Z)({},i.getPluginState().uploadsAssemblies);delete n[t],i.setPluginState({uploadsAssemblies:n}),i.uppy.addResultData(t,{transloadit:e})})))}}),Object.defineProperty((0,h.Z)(i),Hi,{writable:!0,value:function(e){var t;null==(t=i.activeAssemblies[e])||t.close()}}),Object.defineProperty((0,h.Z)(i),Wi,{writable:!0,value:function(e,t){void 0===e&&(e=null);var n=f.getPluginState().uploadsAssemblies[t];null==n||n.forEach(bi(f,Hi)[Hi]),f.client.submitError(e).catch(Zi(e))}}),Object.defineProperty((0,h.Z)(i),Vi,{writable:!0,value:function(e,t){var n,r;if(bi((0,h.Z)(i),Hi)[Hi](null==e||null==(n=e.transloadit)?void 0:n.assembly),null!=t&&null!=(r=t.message)&&r.startsWith("tus: ")){var o,s,a=null==(o=t.originalRequest)||null==(s=o.getUnderlyingObject())?void 0:s.responseURL;i.client.submitError(t,{endpoint:a,type:"TUS_ERROR"}).catch(Zi(t))}}}),i.type="uploader",i.id=i.opts.id||"Transloadit",i.title="Transloadit",i.defaultLocale=gi;var d={service:"https://api2.transloadit.com",errorReporting:!0,waitForEncoding:!1,waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,signature:null,params:null,fields:{},getAssemblyOptions:ki,limit:20,retryDelays:[7e3,1e4,15e3,2e4]};i.opts=(0,o.Z)((0,o.Z)({},d),r),bi((0,h.Z)(i),Pi)[Pi]=new L(i.opts.limit),i.i18nInit();var v=i.opts.getAssemblyOptions!==d.getAssemblyOptions;return i.opts.params?zr(i.opts.params):v||zr(null),i.client=new Ir({service:i.opts.service,client:bi((0,h.Z)(i),Si)[Si](),errorReporting:i.opts.errorReporting,rateLimitedQueue:bi((0,h.Z)(i),Pi)[Pi]}),i.activeAssemblies={},i.assemblyWatchers={},i.completedFiles=Object.create(null),i}return(0,f.Z)(n,[{key:"install",value:function(){this.uppy.addPreProcessor(bi(this,Mi)[Mi]),this.uppy.addPostProcessor(bi(this,zi)[zi]),this.uppy.on("error",bi(this,Wi)[Wi]),this.uppy.on("cancel-all",bi(this,Ii)[Ii]),this.uppy.on("upload-error",bi(this,Vi)[Vi]),this.opts.importFromUploadURLs?this.uppy.on("upload-success",bi(this,ji)[ji]):this.uppy.use(Nt,{storeFingerprintForResuming:!1,useFastRemoteRetry:!1,allowedMetaFields:["assembly_url","filename","fieldname"],limit:this.opts.limit,rateLimitedQueue:bi(this,Pi)[Pi],retryDelays:this.opts.retryDelays}),this.uppy.on("restore:get-data",bi(this,qi)[qi]),this.uppy.on("restored",bi(this,Bi)[Bi]),this.setPluginState({assemblies:{},uploadsAssemblies:{},files:{},results:[]});var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:(0,o.Z)((0,o.Z)({},e),{},{individualCancellation:!1})})}},{key:"uninstall",value:function(){this.uppy.removePreProcessor(bi(this,Mi)[Mi]),this.uppy.removePostProcessor(bi(this,zi)[zi]),this.uppy.off("error",bi(this,Wi)[Wi]),this.opts.importFromUploadURLs&&this.uppy.off("upload-success",bi(this,ji)[ji]);var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:(0,o.Z)((0,o.Z)({},e),{},{individualCancellation:!0})})}},{key:"getAssembly",value:function(e){return this.getPluginState().assemblies[e]}},{key:"getAssemblyFiles",value:function(e){return this.uppy.getFiles().filter((function(t){var n;return(null==t||null==(n=t.transloadit)?void 0:n.assembly)===e}))}}]),n}(z.Z);function Yi(){var e=this,t=["uppy-core:".concat(this.uppy.constructor.VERSION),"uppy-transloadit:".concat(this.constructor.VERSION),"uppy-tus:".concat(Nt.VERSION)],n=function(n,r){var i=e.uppy.getPlugin(n);i&&t.push("".concat(r,":").concat(i.constructor.VERSION))};return this.opts.importFromUploadURLs&&(n("XHRUpload","uppy-xhr-upload"),n("AwsS3","uppy-aws-s3"),n("AwsS3Multipart","uppy-aws-s3-multipart")),n("Dropbox","uppy-dropbox"),n("Box","uppy-box"),n("Facebook","uppy-facebook"),n("GoogleDrive","uppy-google-drive"),n("Instagram","uppy-instagram"),n("OneDrive","uppy-onedrive"),n("Zoom","uppy-zoom"),n("Url","uppy-url"),t.join(",")}function $i(e,t){var n=(0,o.Z)((0,o.Z)({},e.meta),{},{assembly_url:t.assembly_url,filename:e.name,fieldname:"file"}),r=(0,o.Z)((0,o.Z)({},e.tus),{},{endpoint:t.tus_url,addRequestId:!0}),i=e.remote;if(e.remote&&Oi.test(e.remote.companionUrl)){var s=t.companion_url.replace(/\/$/,""),a=e.remote.url.replace(e.remote.companionUrl,"").replace(/^\//,"");i=(0,o.Z)((0,o.Z)({},e.remote),{},{companionUrl:s,url:"".concat(s,"/").concat(a)})}var u=(0,o.Z)((0,o.Z)({},e),{},{transloadit:{assembly:t.assembly_id}});return this.opts.importFromUploadURLs||Object.assign(u,{meta:n,tus:r,remote:i}),u}function Gi(e,t,n){var r=this;return this.uppy.log("[Transloadit] Create Assembly"),this.client.createAssembly({params:n.params,fields:n.fields,expectedFiles:e.length,signature:n.signature}).then(function(){var n=(0,c.Z)((0,l.Z)().mark((function n(s){var a,c,p,f,h,d,v,y,m;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=r.uppy.getFiles().filter((function(t){var n=t.id;return e.includes(n)})),a.length===e.length){n.next=8;break}if(0!==a.length){n.next=6;break}return n.next=5,r.client.cancelAssembly(s);case 5:return n.abrupt("return",null);case 6:return n.next=8,r.client.updateNumberOfFilesInAssembly(s,a.length);case 8:return c=new Ar(s,bi(r,Pi)[Pi]),p=c.status,f=p.assembly_id,h=r.getPluginState(),d=h.assemblies,v=h.uploadsAssemblies,r.setPluginState({assemblies:(0,o.Z)((0,o.Z)({},d),{},(0,u.Z)({},f,p)),uploadsAssemblies:(0,o.Z)((0,o.Z)({},v),{},(0,u.Z)({},t,[].concat((0,i.Z)(v[t]),[f])))}),y={},a.forEach((function(e){y[e.id]=bi(r,Ei)[Ei](e,p)})),r.uppy.setState({files:(0,o.Z)((0,o.Z)({},r.uppy.getState().files),y)}),m=function e(t,n){if("cancel-all"===n)c.close(),r.uppy.off(e);else if(t.id in y){delete y[t.id];var i=Object.keys(y).length;0===i?(c.close(),bi(r,Li)[Li](s).catch((function(){})),r.uppy.off(e)):r.client.updateNumberOfFilesInAssembly(s,i).catch((function(){}))}},r.uppy.on("file-removed",m),r.uppy.emit("transloadit:assembly-created",p,e),r.uppy.log("[Transloadit] Created Assembly ".concat(f)),n.abrupt("return",c);case 21:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){var t=new m.Z("".concat(r.i18n("creatingAssemblyFailed"),": ").concat(e.message),{cause:e});throw"details"in e&&(t.details=e.details),"assembly"in e&&(t.assembly=e.assembly),t}))}function Ji(e,t){var n=this,r=new mi(this.uppy,e);r.on("assembly-complete",(function(e){n.getAssemblyFiles(e).forEach((function(e){n.completedFiles[e.id]=!0,n.uppy.emit("postprocess-complete",e)}))})),r.on("assembly-error",(function(e,t){n.getAssemblyFiles(e).forEach((function(e){n.uppy.emit("upload-error",e,t),n.uppy.emit("postprocess-complete",e)}))})),this.assemblyWatchers[t]=r}function Xi(){return this.opts.waitForEncoding||this.opts.waitForMetadata}function Qi(e,t){var n=this;return Promise.all(t.map((function(t){var r=n.uppy.getFile(t);return n.client.reserveFile(e.status,r)})))}function eo(e){for(var t=this.uppy.getFiles(),n=0;n<t.length;n++){var r=t[n];if(r.uploadURL===e.tus_upload_url)return r;if(r.tus&&r.tus.uploadUrl===e.tus_upload_url)return r;if(!e.is_tus_file&&r.name===e.name&&r.size===e.size)return r}}function to(e,t){var n=this.getPluginState(),r=bi(this,Ti)[Ti](t);r?(this.setPluginState({files:(0,o.Z)((0,o.Z)({},n.files),{},(0,u.Z)({},t.id,{assembly:e,id:r.id,uploadedFile:t}))}),this.uppy.emit("transloadit:upload",t,this.getAssembly(e))):this.uppy.log("[Transloadit] Couldn\u2019t file the file, it was likely removed in the process")}function no(e,t,n){var r=this.getPluginState(),o=r.files[n.original_id];n.localId=o?o.id:null;var s={result:n,stepName:t,id:n.id,assembly:e};this.setPluginState({results:[].concat((0,i.Z)(r.results),[s])}),this.uppy.emit("transloadit:result",t,n,this.getAssembly(e))}function ro(e){var t=this,n=e.assembly_ssl_url;this.client.getAssemblyStatus(n).then((function(e){var n=e.assembly_id,r=t.getPluginState();t.setPluginState({assemblies:(0,o.Z)((0,o.Z)({},r.assemblies),{},(0,u.Z)({},n,e))}),t.uppy.emit("transloadit:complete",e)}))}function io(e){return oo.apply(this,arguments)}function oo(){return(oo=(0,c.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.cancelAssembly(t);case 2:this.uppy.emit("transloadit:assembly-cancelled",t);case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function so(e){var t=this,n=e.status.assembly_id;return this.activeAssemblies[n]=e,e.on("status",(function(e){var r=t.getPluginState().assemblies;t.setPluginState({assemblies:(0,o.Z)((0,o.Z)({},r),{},(0,u.Z)({},n,e))})})),e.on("upload",(function(e){bi(t,Ci)[Ci](n,e)})),e.on("error",(function(n){n.assembly=e.status,t.uppy.emit("transloadit:assembly-error",e.status,n)})),e.on("executing",(function(){t.uppy.emit("transloadit:assembly-executing",e.status)})),this.opts.waitForEncoding&&e.on("result",(function(e,r){bi(t,Fi)[Fi](n,e,r)})),this.opts.waitForEncoding?e.on("finished",(function(){bi(t,Ni)[Ni](e.status)})):this.opts.waitForMetadata&&e.on("metadata",(function(){bi(t,Ni)[Ni](e.status)})),"ASSEMBLY_COMPLETE"===e.ok||e.connect(),e}Ki.VERSION="3.0.2",Ki.COMPANION="https://api2.transloadit.com/companion",Ki.COMPANION_PATTERN=/\.transloadit\.com$/},51853:function(e,t,n){"use strict";var r=n(43144),i=n(15671),o=n(60136),s=n(29388),a=n(98737),u=n(27974),l=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),void 0===r&&(r={}),(o=t.call(this,e)).cause=r.cause,o.cause&&(0,u.Z)(o.cause,"isNetworkError")&&(o.isNetworkError=o.cause.isNetworkError),o}return(0,r.Z)(n)}((0,a.Z)(Error));t.Z=l},61359:function(e,t,n){"use strict";var r=n(43144),i=n(15671),o=n(60136),s=n(29388),a=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),void 0===r&&(r=null),(o=t.call(this,"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.")).cause=e,o.isNetworkError=!0,o.request=r,o}return(0,r.Z)(n)}((0,n(98737).Z)(Error));t.Z=a},11885:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(1413),i=n(15671),o=n(43144),s=n(27974);function a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var u=0;function l(e){return"__private_"+u+++"_"+e}function c(e,t,n){var r=[];return e.forEach((function(e){return"string"!==typeof e?r.push(e):t[Symbol.split](e).forEach((function(e,t,i){""!==e&&r.push(e),t<i.length-1&&r.push(n)}))})),r}function p(e,t){var n=/\$/g,r=[e];if(null==t)return r;for(var i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if("_"!==s){var a=t[s];"string"===typeof a&&(a=n[Symbol.replace](a,"$$$$")),r=c(r,new RegExp("%\\{".concat(s,"\\}"),"g"),a)}}return r}var f=l("apply"),h=function(){function e(t){(0,i.Z)(this,e),Object.defineProperty(this,f,{value:d}),this.locale={strings:{},pluralize:function(e){return 1===e?0:1}},Array.isArray(t)?t.forEach(a(this,f)[f],this):a(this,f)[f](t)}return(0,o.Z)(e,[{key:"translate",value:function(e,t){return this.translateArray(e,t).join("")}},{key:"translateArray",value:function(e,t){if(!(0,s.Z)(this.locale.strings,e))throw new Error("missing string: ".concat(e));var n=this.locale.strings[e];if("object"===typeof n){if(t&&"undefined"!==typeof t.smart_count)return p(n[this.locale.pluralize(t.smart_count)],t);throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return p(n,t)}}]),e}();function d(e){if(null!=e&&e.strings){var t=this.locale;this.locale=(0,r.Z)((0,r.Z)({},t),{},{strings:(0,r.Z)((0,r.Z)({},t.strings),e.strings)}),this.locale.pluralize=e.pluralize||t.pluralize}}},73411:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(61359);function i(){return fetch.apply(void 0,arguments).catch((function(e){throw"AbortError"===e.name?e:new r.Z(e)}))}},68594:function(e,t,n){"use strict";function r(e){var t="";return e.replace(/[^A-Z0-9]/gi,(function(e){return t+="-".concat(function(e){return e.charCodeAt(0).toString(32)}(e)),"/"}))+t}function i(e){var t="uppy";return"string"===typeof e.name&&(t+="-".concat(r(e.name.toLowerCase()))),void 0!==e.type&&(t+="-".concat(e.type)),e.meta&&"string"===typeof e.meta.relativePath&&(t+="-".concat(r(e.meta.relativePath.toLowerCase()))),void 0!==e.data.size&&(t+="-".concat(e.data.size)),void 0!==e.data.lastModified&&(t+="-".concat(e.data.lastModified)),t}n.d(t,{Z:function(){return i}})},13377:function(e,t,n){"use strict";function r(e){var t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}n.d(t,{Z:function(){return r}})},53700:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(13377),i=n(75611);function o(e){var t;if(e.type)return e.type;var n=e.name?null==(t=(0,r.Z)(e.name).extension)?void 0:t.toLowerCase():null;return n&&n in i.Z?i.Z[n]:"application/octet-stream"}},4692:function(e,t){"use strict";t.Z=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir}},27974:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.d(t,{Z:function(){return r}})},8165:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.nodeType)===Node.ELEMENT_NODE}n.d(t,{Z:function(){return r}})},75611:function(e,t){"use strict";t.Z={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"}}}]);
//# sourceMappingURL=5166.4360ce9f.chunk.js.map